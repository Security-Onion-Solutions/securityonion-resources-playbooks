name: ET GAMES Gold VIP Club Casino Client in Use
id: 22007746
description: |
  Detects usage of Gold VIP Club Casino client software based on specific network traffic patterns.
  May indicate legitimate gaming activity or potential policy violation depending on organizational guidelines.
type: detection
detection_id: 2007746
detection_category:
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  # Type 1: Artifact Analysis
  - question: What was the exact network payload containing the Gold VIP Club Casino identifier?
    context: Understanding the complete payload helps determine the specific casino client version and activity type.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - payload
        - payload_printable
        - alert.signature

  - question: What specific network protocol and port was used for this casino client communication?
    context: Protocol details help identify the type of casino client activity and communication method.
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          community_id|expand: '%community_id%'
        condition: selection
      fields:
        - network.protocol
        - network.transport
        - dst_port
        - network.bytes

  # Type 2: Triage Assessment
  - question: Is online gaming software permitted for this user or system?
    context: Some organizations allow recreational software usage during breaks or have specific gaming policies.
    range: -7d
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_port: 20000
        condition: selection
      fields:
        - dst_ip
        - network.bytes
        - network.packets

  - question: Does this occur during authorized break times or after business hours?
    context: Timing of gaming activity helps determine if this violates organizational policy.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - network.bytes

  # Type 3: Activity Context
  - question: What process executed the Gold VIP Club Casino client software?
    context: Identifying the source process helps determine if this was intentional user activity or unwanted software.
    range: -30m
    query: |
      aggregation: false
      logsource:
        category: process_creation
      detection:
        selection:
          host.ip|expand: '%src_ip%'
          process.name|contains:
            - 'casino'
            - 'game'
            - 'gold'
            - 'vip'
        condition: selection
      fields:
        - process.name
        - process.command_line
        - process.parent.name
        - User

  - question: Was this casino software recently installed or downloaded?
    context: Recent installation may indicate intentional user activity or potentially unwanted program installation.
    range: -24h
    query: |
      aggregation: false
      logsource:
        category: file_event
      detection:
        selection:
          host.ip|expand: '%src_ip%'
          file.name|contains:
            - 'casino'
            - 'game'
            - 'gold'
            - 'vip'
        condition: selection
      fields:
        - file.path
        - file.name
        - event.action
        - process.name

  - question: What web browsing activity preceded this casino client usage?
    context: Web activity may reveal how the casino software was obtained or accessed.
    range: -1h
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - url.domain
        - url.path
        - http.request.method
        - http.response.status_code

  # Type 4: Impact Assessment
  - question: How much network bandwidth was consumed by this casino client activity?
    context: High bandwidth usage may impact business operations or indicate extensive gaming activity.
    range: +2h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_port: 20000
        condition: selection
      fields:
        - dst_ip
        - network.bytes
        - network.packets

  - question: Are there signs of financial transactions or payment processing?
    context: Financial activity associated with casino software may indicate real money gambling violations.
    range: +4h
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          url.path|contains:
            - 'payment'
            - 'transaction'
            - 'deposit'
            - 'withdraw'
        condition: selection
      fields:
        - url.domain
        - url.path
        - http.request.method

  # Type 5: Forensic Deep-Dive
  - question: What other gaming or casino-related software is installed on this system?
    context: Multiple gaming applications may indicate pattern of policy violations or potentially unwanted programs.
    range: -7d
    query: |
      aggregation: false
      logsource:
        category: process_creation
      detection:
        selection:
          host.ip|expand: '%src_ip%'
          process.name|contains:
            - 'casino'
            - 'poker'
            - 'slot'
            - 'game'
            - 'bet'
        condition: selection
      fields:
        - process.name
        - process.command_line
        - process.executable
        - User

  - question: Are there registry modifications associated with casino software installation?
    context: Registry changes may indicate persistent installation of gaming software or adware components.
    range: -24h
    query: |
      aggregation: false
      logsource:
        category: registry_event
      detection:
        selection:
          host.ip|expand: '%src_ip%'
          registry.key|contains:
            - 'casino'
            - 'game'
            - 'gold'
        condition: selection
      fields:
        - registry.key
        - registry.value.name
        - registry.value.data
        - process.name

  # Type 6: Enterprise Correlation
  - question: Are other users accessing casino or gaming software across the organization?
    context: Multiple users with gaming software may indicate policy enforcement needs or malware campaign.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          dst_port: 20000
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - network.bytes