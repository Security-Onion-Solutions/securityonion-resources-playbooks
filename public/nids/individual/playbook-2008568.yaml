name: ET SCAN Voiper Toolkit Torturer Scan
id: 22008568
description: |
  Detects Voiper Toolkit's "Torturer" component scanning SIP services with unusual method names.
  This tool performs aggressive SIP service enumeration and vulnerability testing.
  May trigger on legitimate SIP testing or debugging tools using non-standard methods.
type: detection
detection_id: 2008568
detection_category:
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  # Type 1: Artifact Analysis
  - question: What were the specific unusual SIP methods and URIs detected in the scan?
    context: Voiper Torturer uses distinctive method names and URI patterns to test SIP service responses.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - payload_printable
        - app_proto
        - flow.pkts_toserver

  - question: What was the complete SIP message structure used in this reconnaissance attempt?
    context: Analyzing the full SIP packet reveals the tool's fingerprint and testing methodology.
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          community_id|expand: '%community_id%'
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - src_port
        - dst_port
        - bytes_toserver

  # Type 2: Triage Assessment
  - question: Is this source conducting authorized SIP penetration testing or security assessment?
    context: Voiper Toolkit is sometimes used by security professionals for legitimate VoIP testing.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_port: 5060
        condition: selection
      fields:
        - dst_ip
        - conn_state
        - duration

  - question: Are there any documented security assessments scheduled for our VoIP infrastructure?
    context: Distinguishing between authorized testing and malicious reconnaissance activities.
    range: -7d
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          dst_ip|expand: '%dst_ip%'
          rule.category: 'SCAN'
        condition: selection
      fields:
        - src_ip
        - rule.name
        - count

  # Type 3: Activity Context
  - question: What other Voiper Toolkit components or VoIP scanning tools were used from this source?
    context: Voiper Toolkit includes multiple modules that may be used in sequence during assessment.
    range: +/-30m
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          rule.name|contains:
            - 'Voiper'
            - 'SIP'
            - 'VOIP'
        condition: selection
      fields:
        - rule.name
        - dst_ip
        - rule.signature_id

  - question: Was this scan preceded by network discovery or port scanning activity?
    context: VoIP-specific tools are often used after initial network reconnaissance identifies SIP services.
    range: -1h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          rule.category|contains:
            - 'SCAN'
            - 'RECON'
        condition: selection
      fields:
        - rule.name
        - dst_ip
        - dst_port

  - question: What was the timing pattern and frequency of these unusual SIP method probes?
    context: Understanding scan timing helps determine if this is automated tooling or manual testing.
    range: +/-15m
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
          dst_port: 5060
        condition: selection
      fields:
        - flow.start
        - duration
        - conn_state

  # Type 4: Impact Assessment
  - question: How did the targeted SIP service respond to these unusual method probes?
    context: Service responses reveal configuration details and potential vulnerabilities.
    range: +5m
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%dst_ip%'
          dst_ip|expand: '%src_ip%'
          src_port|expand: '%dst_port%'
        condition: selection
      fields:
        - bytes_toclient
        - conn_state
        - duration

  - question: Are there signs of successful service enumeration or vulnerability identification?
    context: Successful reconnaissance may lead to follow-up exploitation attempts.
    range: +2h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
          rule.category|contains:
            - 'ATTACK'
            - 'EXPLOIT'
            - 'TROJAN'
        condition: selection
      fields:
        - rule.name
        - rule.category

  # Type 5: Forensic Deep-Dive
  - question: What specific Voiper Toolkit version or configuration is indicated by these method signatures?
    context: Different toolkit versions use varying method names and testing approaches.
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          rule.name|contains: 'Voiper'
        condition: selection
      fields:
        - rule.name
        - rule.signature_id
        - rule.rev

  - question: What is the infrastructure profile and reputation of the scanning source?
    context: Understanding attacker infrastructure helps assess threat level and potential attribution.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - src_ip
        - geoip.country_name
        - geoip.asn

  # Type 6: Enterprise Correlation
  - question: Are other VoIP endpoints in our network experiencing similar Voiper Toolkit scanning?
    context: Coordinated scanning indicates systematic reconnaissance of communication infrastructure.
    range: +/-1h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          rule.signature_id: 2008568
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - count

  - question: Is this VoIP scanning part of broader communication system reconnaissance across our organization?
    context: VoIP attacks often target multiple communication channels for comprehensive compromise.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          rule.category: 'SCAN'
          dst_port|contains:
            - 25
            - 80
            - 443
            - 993
            - 5060
            - 5061
        condition: selection
      fields:
        - src_ip
        - dst_port
        - rule.name