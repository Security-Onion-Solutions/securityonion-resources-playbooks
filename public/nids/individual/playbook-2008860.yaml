name: ET TELNET External Telnet Attempt To Cisco Device With No Telnet Password Set
id: 22008860
description: |
  Detects external attempts to access Cisco devices via Telnet when no password is configured.
  Indicates potential unauthorized access attempts to network infrastructure.
  May also trigger during legitimate network administration or device configuration.
type: detection
detection_id: 2008860
detection_category:
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  # Type 1: Artifact Analysis
  - question: What was the exact Cisco device response message detected?
    context: The specific error message reveals the device model and security configuration status.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - payload
        - telnet.command
        - telnet.response

  - question: What Cisco device model and version is responding with this error?
    context: Understanding the device type helps assess the criticality and potential impact of unauthorized access.
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          community_id|expand: '%community_id%'
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - src_port
        - bytes_toclient

  # Type 2: Triage Assessment
  - question: Is this external source authorized to manage network devices?
    context: Legitimate network administrators may attempt device access during configuration or troubleshooting.
    range: -30d
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_port: 23
        condition: selection
      fields:
        - dst_ip
        - connection_count

  - question: Does this align with scheduled network maintenance windows?
    context: Network device configuration often occurs during planned maintenance periods.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          dst_ip|expand: '%dst_ip%'
          dst_port|contains:
            - 22
            - 23
            - 443
        condition: selection
      fields:
        - src_ip
        - connection_count

  # Type 3: Activity Context
  - question: What other network devices has this external source attempted to access?
    context: Understanding the scope of device access attempts reveals potential network reconnaissance or attack patterns.
    range: -2h/+2h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_port|contains:
            - 22
            - 23
            - 161
            - 443
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - connection_count

  - question: What was the sequence of connection attempts to this Cisco device?
    context: Multiple connection attempts may indicate brute force or systematic probing of network infrastructure.
    range: -1h/+1h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
          dst_port: 23
        condition: selection
      fields:
        - connection_count
        - bytes_toserver

  # Type 4: Impact Assessment
  - question: Has this Cisco device been successfully accessed despite the password requirement?
    context: Successful access to network infrastructure poses significant security risks and potential for lateral movement.
    range: +30m
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
          dst_port: 23
          connection_state: 'established'
        condition: selection
      fields:
        - duration
        - bytes_toserver
        - bytes_toclient

  - question: Are there signs of configuration changes or command execution on the device?
    context: Device configuration changes following access attempts indicate successful compromise and potential network impact.
    range: +2h
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          dst_ip|expand: '%dst_ip%'
          dst_port|contains:
            - 161
            - 443
            - 22
        condition: selection
      fields:
        - src_ip
        - bytes_toserver
        - duration

  # Type 5: Forensic Deep-Dive
  - question: What is the geographic and organizational origin of this external access attempt?
    context: Understanding the source helps determine if this is targeted reconnaissance or opportunistic scanning.
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - connection_count

  - question: Are there indicators of automated scanning tools or manual interaction patterns?
    context: Distinguishing between automated tools and manual access attempts helps understand attacker sophistication.
    range: -30m/+30m
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - dst_port
        - connection_count
        - unique_destinations

  # Type 6: Enterprise Correlation
  - question: Are other network devices experiencing similar unauthorized access attempts?
    context: Widespread device access attempts indicate systematic network infrastructure reconnaissance.
    range: -24h/+24h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          rule.name|contains:
            - 'telnet'
            - 'cisco'
            - 'device'
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - alert_count

  - question: Is this part of a broader network infrastructure attack campaign?
    context: Correlating with other infrastructure-focused attacks reveals the scope of potential network compromise.
    range: -7d
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          rule.category|contains:
            - 'network'
            - 'infrastructure'
            - 'device'
        condition: selection
      fields:
        - src_ip
        - rule.name
        - alert_count