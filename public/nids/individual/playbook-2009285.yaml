name: ET SHELLCODE Bindshell2 Decoder Shellcode (UDP)
id: 22009285
description: |
  Detects UDP traffic containing Bindshell2 decoder shellcode patterns.
  May indicate exploit payload delivery or legitimate security testing.
type: detection
detection_id: 2009285
detection_category:
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  - question: What was the complete UDP payload containing the shellcode pattern?
    context: Analyzing the full payload reveals the shellcode's purpose and target architecture.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - src_port
        - dst_port
        - payload
  - question: Is this traffic part of authorized penetration testing?
    context: Legitimate security testing may use shellcode patterns for vulnerability assessment.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
        condition: selection
      fields:
        - src_port
        - dst_port
        - connection_state
        - bytes_out
  - question: What service was targeted by this shellcode delivery?
    context: Understanding the target service helps determine the exploit's intent and impact.
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          dst_ip|expand: '%dst_ip%'
          dst_port|expand: '%dst_port%'
        condition: selection
      fields:
        - src_ip
        - connection_state
        - service
  - question: Did the shellcode successfully establish a bind shell connection?
    context: Successful exploitation would result in new inbound connections to the target.
    range: +30m
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          dst_ip|expand: '%dst_ip%'
          connection_state: 'established'
        condition: selection
      fields:
        - src_ip
        - dst_port
        - bytes_in
        - bytes_out
  - question: What other exploit attempts originated from this source?
    context: Multiple exploit attempts may indicate systematic attack behavior.
    range: -2h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          alert.category|contains:
            - 'SHELLCODE'
            - 'EXPLOIT'
        condition: selection
      fields:
        - dst_ip
        - alert.signature
        - alert.severity
  - question: Are there signs of post-exploitation activity on the target?
    context: Successful shellcode execution enables further malicious activities.
    range: +2h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%dst_ip%'
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - bytes_out
        - connection_state
  - question: What processes were running on the target during the attack?
    context: Active processes may indicate vulnerable services or successful exploitation.
    range: +/-15m
    query: |
      aggregation: true
      logsource:
        category: process_creation
      detection:
        selection:
          host.ip|expand: '%dst_ip%'
        condition: selection
      fields:
        - Image
        - CommandLine
        - User
  - question: Has this shellcode pattern been observed in other network locations?
    context: Similar patterns across multiple hosts may indicate a coordinated attack campaign.
    range: -7d
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          alert.signature|contains: 'Bindshell2 Decoder'
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - alert.signature
  - question: What defensive measures were triggered by this activity?
    context: Security controls may have blocked or logged additional related activities.
    range: +/-30m
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          dst_ip|expand: '%dst_ip%'
          alert.action|contains:
            - 'blocked'
            - 'denied'
        condition: selection
      fields:
        - alert.signature
        - src_ip
        - alert.action