name: ET WEB_SPECIFIC_APPS WP Forum Server wordpress plugin SQL Injection Attempt -- feed.php topic SELECT
id: 22012431
description: |
  Detects SQL injection attempts against WordPress Forum Server plugin via the feed.php topic parameter using SELECT statements.
  May trigger on legitimate forum RSS feed requests that include complex topic queries.
type: detection
detection_id: 2012431
detection_category:
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  - question: What was the complete SELECT SQL injection payload in the topic parameter?
    context: Understanding the SELECT statement reveals what database information the attacker attempted to extract.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - http.request.body.content
        - url.full
        - url.query

  - question: Is this legitimate WordPress Forum Server plugin usage by authorized users?
    context: The forum plugin may generate legitimate RSS feeds with complex topic queries.
    range: -7d
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          dst_ip|expand: '%dst_ip%'
          url.path|contains: "/wp-content/plugins/forum-server/"
        condition: selection
      fields:
        - src_ip
        - url.path
        - user_agent.original

  - question: What other WordPress vulnerabilities are being exploited from this source?
    context: Attackers often target multiple WordPress plugins and core vulnerabilities.
    range: -2h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          rule.name|contains: "WordPress"
        condition: selection
      fields:
        - dst_ip
        - rule.name
        - url.path

  - question: What was the HTTP response to this SELECT injection attempt?
    context: Response content may reveal successful data extraction or error messages.
    range: +5m
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          community_id|expand: '%community_id%'
        condition: selection
      fields:
        - http.response.status_code
        - http.response.body.content
        - http.response.bytes

  - question: Did the attacker enumerate WordPress structure before the injection?
    context: Successful WordPress attacks often follow reconnaissance of plugins and themes.
    range: -30m
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
          url.path|contains:
            - "/wp-content/"
            - "/wp-admin/"
            - "/wp-includes/"
        condition: selection
      fields:
        - url.path
        - http.response.status_code
        - http.request.method

  - question: Are there signs of successful database enumeration or data extraction?
    context: Successful SELECT injections may reveal user credentials, post content, or database structure.
    range: +15m
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%dst_ip%'
          network.protocol: "tcp"
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - network.bytes
        - network.packets

  - question: What WordPress user context was this injection attempt made under?
    context: Understanding authentication status helps determine if legitimate accounts were compromised.
    range: -15m
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
          url.path|contains: "wp-login"
        condition: selection
      fields:
        - http.request.method
        - http.response.status_code
        - url.query

  - question: What specific database tables or columns were targeted in the SELECT query?
    context: Payload analysis reveals which WordPress data the attacker attempted to access.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - http.request.body.content
        - url.query
        - rule.description

  - question: Are there concurrent attacks against other WordPress installations?
    context: Automated tools often target multiple WordPress sites with the same vulnerability.
    range: -1h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          rule.name|contains: "WordPress"
        condition: selection
      fields:
        - dst_ip
        - rule.name
        - url.path

  - question: Is this part of a broader WordPress plugin exploitation campaign?
    context: Attackers may systematically target vulnerable WordPress plugins across the enterprise.
    range: -4h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          rule.name|contains: "WP"
          rule.name|contains: "plugin"
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - rule.name