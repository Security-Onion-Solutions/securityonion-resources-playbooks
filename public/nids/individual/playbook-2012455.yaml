name: ET MOBILE_MALWARE Android Trojan Fake10086 checkin 2
id: 22012455
description: |
  Detects Android Fake10086 trojan communication with command and control servers via HTTP requests containing specific device and installation parameters.
  May trigger on legitimate mobile applications that use similar parameter structures for device registration or analytics.
type: detection
detection_id: 2012455
detection_category:
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  - question: What device information is being transmitted in the trojan checkin?
    context: The pid, ver, area, insttime, and first parameters reveal device identifiers, location, and installation details.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - http.request.body.content
        - url.full
        - url.query

  - question: What specific version and configuration of Fake10086 trojan is installed?
    context: Version information helps identify the trojan variant and its capabilities for data theft and fraud.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - url.query
        - http.request.headers

  - question: Is this legitimate mobile carrier or telecom application traffic?
    context: The Fake10086 name mimics China Mobile's 10086 service, so legitimate telecom apps might use similar patterns.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
        condition: selection
      fields:
        - src_ip
        - url.path
        - http.request.method

  - question: Are there other devices communicating with this Fake10086 C2 server?
    context: Multiple infected devices indicate the scope of the trojan campaign and potential victim count.
    range: -6h
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          dst_ip|expand: '%dst_ip%'
          url.path|contains: 'req.php'
        condition: selection
      fields:
        - src_ip
        - url.query
        - http.response.status_code

  - question: What initiated this trojan installation and first checkin?
    context: Understanding the infection vector helps identify how the fake telecom app was distributed and installed.
    range: -2h
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - url.path
        - http.request.method
        - http.response.status_code

  - question: How is the C2 server responding to trojan checkins?
    context: Server responses may contain fraud instructions, SMS interception commands, or additional payload downloads.
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          community_id|expand: '%community_id%'
        condition: selection
      fields:
        - http.response.status_code
        - http.response.body.content
        - http.response.body.bytes

  - question: Is the trojan successfully establishing persistent communication?
    context: Regular checkins indicate active compromise and ongoing capability for SMS fraud and data theft.
    range: +2h
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
          url.path|contains: 'req.php'
        condition: selection
      fields:
        - url.query
        - http.response.status_code

  - question: What SMS fraud or financial theft capabilities are being activated?
    context: Fake10086 trojans typically intercept SMS messages for banking fraud and premium service subscriptions.
    range: +1h
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
        condition: selection
      fields:
        - url.path
        - http.response.body.content

  - question: Are there signs of SMS interception or premium service fraud?
    context: The trojan may be receiving commands to intercept verification codes or subscribe to premium services.
    range: +4h
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - url.path
        - http.request.body.content

  - question: What geographic area information is being reported by the trojan?
    context: The area parameter reveals the geographic targeting of the fraud campaign and victim locations.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - url.query

  - question: Are other mobile devices showing similar Fake10086 infections?
    context: Mobile malware campaigns often target multiple devices in the same network or geographic region.
    range: -12h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          rule.name|contains: 'Fake10086'
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - url.full

  - question: Is this part of a coordinated Android fraud campaign?
    context: Fake telecom apps are often part of larger mobile fraud operations targeting banking and premium services.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          rule.name|contains: 'MOBILE_MALWARE'
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - rule.name