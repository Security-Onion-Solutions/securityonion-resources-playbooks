name: ET WEB_SPECIFIC_APPS webEdition CMS openBrowser.php Cross Site Scripting Attempt
id: 22012678
description: |
  Detects Cross-Site Scripting (XSS) attempts targeting webEdition CMS openBrowser.php with onload parameter.
  May trigger on legitimate JavaScript usage but onload in URL parameters is typically malicious.
type: detection
detection_id: 2012678
detection_category:
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  - question: What was the complete XSS payload in the onload parameter?
    context: Understanding the JavaScript payload reveals the attacker's intent and potential impact.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - http.request.body.content
        - url.full
        - url.query
  - question: Is this onload parameter usage part of legitimate webEdition CMS functionality?
    context: CMS systems may have legitimate JavaScript handlers but onload in URLs is suspicious.
    range: -14d
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          dst_ip|expand: '%dst_ip%'
          url.path|contains: '/openBrowser.php'
        condition: selection
      fields:
        - src_ip
        - user_agent.original
        - url.query
  - question: What web application reconnaissance preceded this XSS attempt?
    context: Attackers typically probe for XSS vulnerabilities before crafting specific payloads.
    range: -30m
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
        condition: selection
      fields:
        - url.path
        - url.query
        - http.response.status_code
  - question: Did the XSS payload execute successfully based on response characteristics?
    context: Response codes and content length indicate whether the malicious script was processed.
    range: +5m
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          community_id|expand: '%community_id%'
        condition: selection
      fields:
        - http.response.status_code
        - http.response.body.bytes
        - content_type
  - question: What JavaScript functions or events are being exploited in the payload?
    context: Understanding the XSS technique reveals potential for session hijacking or data theft.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - alert.signature
        - http.request.body.content
        - url.query
  - question: Are there signs of session hijacking or credential theft following the XSS?
    context: Successful XSS attacks often lead to cookie theft or unauthorized session access.
    range: +1h
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
        condition: selection
      fields:
        - url.path
        - http.request.headers
        - user_agent.original
  - question: What browser or client characteristics indicate the attack vector?
    context: XSS attacks may target specific browsers or use social engineering techniques.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - user_agent.original
        - src_ip
        - http.request.referrer
  - question: Has this attacker attempted other XSS or web application attacks?
    context: XSS attempts are often part of broader web application security testing or exploitation.
    range: -2h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          alert.category|contains: 'web-application-attack'
        condition: selection
      fields:
        - alert.signature
        - dst_ip
        - url.path
  - question: Are there indicators of malicious redirects or phishing attempts?
    context: XSS attacks often redirect users to malicious sites for credential harvesting.
    range: +30m
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - url.full
        - http.response.status_code
        - http.request.referrer
  - question: What is the scope of XSS attacks across webEdition CMS installations?
    context: Widespread XSS attempts may indicate automated scanning or coordinated attacks.
    range: -6h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          alert.signature|contains: 'Cross Site Scripting'
        condition: selection
      fields:
        - dst_ip
        - alert.signature
        - url.path
  - question: Are other webEdition CMS systems being targeted with similar XSS attempts?
    context: Coordinated XSS attacks suggest knowledge of specific CMS vulnerabilities.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          alert.signature|contains: 'webEdition CMS'
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - url.query