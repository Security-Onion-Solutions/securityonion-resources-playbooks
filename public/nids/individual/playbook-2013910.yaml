name: ET GAMES Second Life setup download
id: 22013910
description: |
  Detects downloads of the Second Life virtual world client setup executable.
  May indicate legitimate gaming activity or potential policy violations depending on organizational acceptable use policies.
type: detection
detection_id: 2013910
detection_category:
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  # Type 1: Artifact Analysis
  - question: What was the complete download URL and file details for the Second Life setup?
    context: Understanding the exact download source helps verify legitimacy and identify potential malware masquerading as game clients.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - http.request.method
        - url.full
        - http.response.status_code

  - question: What is the file size and HTTP response details for this Second Life download?
    context: Analyzing download characteristics helps distinguish legitimate client downloads from malicious payloads.
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
          community_id|expand: '%community_id%'
        condition: selection
      fields:
        - http.response.bytes
        - http.response.status_code
        - http.response.mime_type

  # Type 2: Triage Assessment
  - question: Is this user authorized to install gaming software on their workstation?
    context: Many organizations have policies restricting game installations on corporate devices.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          url.path|contains:
            - ".exe"
            - "setup"
            - "install"
        condition: selection
      fields:
        - src_ip
        - url.full
        - http.request.method

  - question: Does this download occur during business hours or personal time?
    context: Gaming downloads during business hours may indicate policy violations or personal use of corporate resources.
    range: +/-2h
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          url.path|contains:
            - "game"
            - "entertainment"
        condition: selection
      fields:
        - src_ip
        - url.full
        - user_agent.original

  # Type 3: Activity Context
  - question: What other gaming or entertainment downloads occurred from this workstation?
    context: Multiple gaming downloads may indicate systematic policy violations or personal use patterns.
    range: +/-7d
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          url.path|contains:
            - "game"
            - ".exe"
            - "setup"
        condition: selection
      fields:
        - url.full
        - http.response.bytes
        - user_agent.original

  - question: What was the user's browsing activity leading up to this download?
    context: Understanding the browsing context helps determine if this was intentional gaming or accidental download.
    range: -30m
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - url.full
        - http.request.method
        - http.response.status_code

  # Type 4: Impact Assessment
  - question: Was the Second Life setup file successfully downloaded and potentially executed?
    context: Completed downloads may lead to software installation and ongoing policy violations.
    range: +30m
    query: |
      aggregation: true
      logsource:
        category: process_creation
      detection:
        selection:
          host.ip|expand: '%src_ip%'
          Image|contains:
            - "Second_Life_Setup.exe"
            - "SecondLife"
        condition: selection
      fields:
        - User
        - Image
        - CommandLine

  - question: Are there signs of the Second Life client being installed or running?
    context: Successful installation may result in ongoing network traffic and resource usage.
    range: +2h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_port|contains:
            - 443
            - 80
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - bytes_sent

  # Type 5: Forensic Deep-Dive
  - question: What is the reputation and legitimacy of the download source domain?
    context: Verifying the download source helps distinguish legitimate Second Life downloads from malware distribution.
    range: -1h
    query: |
      aggregation: true
      logsource:
        category: network
        service: dns
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dns.query.name|expand: '%dst_ip%'
        condition: selection
      fields:
        - dns.query.name
        - dns.resolved_ip
        - dns.query.type_name

  - question: Are there any security concerns or malware associations with this specific download?
    context: Gaming clients are sometimes used as vectors for malware distribution or may contain unwanted software.
    range: +1h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          rule.category|contains:
            - "trojan-activity"
            - "malware"
        condition: selection
      fields:
        - rule.name
        - alert.severity
        - dst_ip

  # Type 6: Enterprise Correlation
  - question: Are other users in the organization downloading gaming software or similar entertainment applications?
    context: Multiple gaming downloads may indicate broader policy compliance issues or security awareness gaps.
    range: +/-24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          url.path|contains:
            - "game"
            - "setup.exe"
            - "entertainment"
        condition: selection
      fields:
        - src_ip
        - url.full
        - http.response.bytes

  - question: Is this part of a pattern of policy violations or unauthorized software installations?
    context: Gaming downloads may be part of broader acceptable use policy violations requiring management attention.
    range: -30d
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          rule.category|contains:
            - "policy-violation"
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - rule.name
        - alert.severity
        - dst_ip