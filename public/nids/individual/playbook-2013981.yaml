name: ET WEB_SPECIFIC_APPS Orbis editor-body.php script Cross Site Scripting Attempt
id: 22013981
description: |
  Detects cross-site scripting (XSS) attempts targeting Orbis CMS editor-body.php script.
  This alert indicates potential web application exploitation attempting to inject malicious JavaScript into the Orbis content management system.
  Legitimate use of editor-body.php should not contain script tags or event handlers in the 's' parameter.
type: detection
detection_id: 2013981
detection_category:
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  - question: What was the exact XSS payload injected into the Orbis editor-body.php script parameter?
    context: The specific payload reveals the attacker's technique and potential impact on the CMS administration interface.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - http.request.method
        - url.full
        - url.query

  - question: What JavaScript events or script elements were detected in the malicious request?
    context: Different XSS vectors indicate the sophistication level and potential for administrative session compromise.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - http.request.body.content
        - http.user_agent

  - question: Is this a legitimate administrator accessing the Orbis CMS admin interface?
    context: CMS administrators regularly access editor interfaces, but should not trigger XSS detection patterns.
    range: -7d
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          url.path|contains:
            - "/admin/"
            - "editor"
        condition: selection
      fields:
        - url.full
        - http.user_agent

  - question: What other CMS-related attacks have been attempted from this source IP?
    context: XSS attempts against CMS systems often occur alongside other web application exploitation attempts.
    range: +/-4h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          rule.category: "WEB_APPLICATION_ATTACK"
        condition: selection
      fields:
        - rule.name
        - dst_ip
        - url.path

  - question: Has the Orbis CMS server responded with authentication challenges or error pages?
    context: Server responses indicate whether the attacker has valid credentials or is attempting unauthorized access.
    range: +10m
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          dst_ip|expand: '%dst_ip%'
          src_ip|expand: '%src_ip%'
          url.path|contains: "/admin/"
        condition: selection
      fields:
        - http.response.status_code
        - http.response.body.bytes

  - question: Are there signs of successful XSS exploitation or administrative session compromise?
    context: Successful XSS in CMS admin interfaces can lead to content manipulation or credential theft.
    range: +1h
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
        condition: selection
      fields:
        - http.request.headers
        - url.full
        - http.request.method

  - question: What is the attack pattern and timing suggesting automated vs manual exploitation?
    context: CMS exploitation patterns help determine if this is targeted attack or automated vulnerability scanning.
    range: +/-1h
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
        condition: selection
      fields:
        - url.path
        - http.user_agent
        - http.request.method

  - question: Has this Orbis XSS vulnerability been exploited against other systems in the network?
    context: Successful exploitation of one CMS instance may indicate broader vulnerability across the organization.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          rule.name|contains: "Orbis"
        condition: selection
      fields:
        - src_ip
        - dst_ip

  - question: What content management activities occurred before this XSS attempt?
    context: Understanding normal CMS usage patterns helps distinguish between legitimate and malicious activity.
    range: -2h
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          dst_ip|expand: '%dst_ip%'
          url.path|contains: "/admin/"
        condition: selection
      fields:
        - src_ip
        - url.full
        - http.request.method

  - question: Are there indicators of post-exploitation activity or lateral movement?
    context: Successful CMS compromise may lead to further system access or network reconnaissance.
    range: +2h
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - network.protocol

  - question: What security headers and protections are implemented on the Orbis CMS server?
    context: Understanding existing security controls helps assess the likelihood of successful XSS exploitation.
    range: +/-30m
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          dst_ip|expand: '%dst_ip%'
        condition: selection
      fields:
        - http.response.headers
        - http.response.status_code