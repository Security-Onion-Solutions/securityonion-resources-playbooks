name: ET MALWARE US-CERT TA14-353A Lightweight Backdoor 2
id: 22020008
description: |
  Detects network traffic to port 488 matching US-CERT TA14-353A lightweight backdoor signature.
  This specific byte pattern on port 488 indicates communication with a known backdoor implant.
  Port 488 is rarely used by legitimate applications, increasing detection confidence.
type: detection
detection_id: 2020008
detection_category:
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  # Type 1: Artifact Analysis
  - question: What was the complete payload sent to port 488 containing the backdoor signature?
    context: Analyzing the full payload reveals the backdoor's command structure and potential instructions.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - payload
        - payload_printable
        - flow_id

  - question: What is the significance of port 488 in this backdoor communication?
    context: Understanding the port choice helps identify the backdoor's network configuration and stealth techniques.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          dst_port: 488
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - service
        - conn_state

  - question: How does this lightweight backdoor signature differ from the listening implant variants?
    context: Comparing signatures helps understand the malware family's different components and capabilities.
    range: -24h
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          alert.signature|contains: "TA14-353A"
        condition: selection
      fields:
        - alert.signature
        - rule.name
        - dst_port

  # Type 2: Triage Assessment
  - question: Is port 488 normally used by any legitimate services on this network?
    context: Port 488 usage is extremely rare in legitimate environments, making this likely malicious.
    range: -30d
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          dst_port: 488
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - service

  - question: Has this source system previously communicated on port 488?
    context: First-time port 488 usage strongly indicates new backdoor deployment.
    range: -7d
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_port: 488
        condition: selection
      fields:
        - dst_ip
        - bytes_toserver
        - bytes_toclient

  # Type 3: Activity Context
  - question: What process on the source system initiated this port 488 connection?
    context: Identifying the initiating process helps understand how the backdoor was deployed.
    range: -30m
    query: |
      aggregation: false
      logsource:
        category: process_creation
      detection:
        selection:
          host.ip|expand: '%src_ip%'
        condition: selection
      fields:
        - Image
        - CommandLine
        - ProcessGuid
        - ParentImage

  - question: What network activity occurred before this backdoor communication?
    context: Understanding the attack sequence helps identify the initial compromise vector.
    range: -2h
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - service
        - bytes_toserver

  - question: Were there any file system changes before the backdoor activated?
    context: File modifications may indicate backdoor installation or configuration changes.
    range: -1h
    query: |
      aggregation: false
      logsource:
        category: file_event
      detection:
        selection:
          host.ip|expand: '%src_ip%'
        condition: selection
      fields:
        - TargetFilename
        - file.hash.md5
        - ProcessGuid

  # Type 4: Impact Assessment
  - question: Has the backdoor successfully established a persistent connection channel?
    context: Successful backdoor deployment enables ongoing unauthorized access and control.
    range: +4h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_port: 488
        condition: selection
      fields:
        - dst_ip
        - bytes_toserver
        - bytes_toclient
        - duration

  - question: What commands or data have been transmitted through this backdoor channel?
    context: Analyzing backdoor communications helps assess the scope of unauthorized access.
    range: +6h
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          community_id|expand: '%community_id%'
        condition: selection
      fields:
        - bytes_toserver
        - bytes_toclient
        - pkts_toserver
        - pkts_toclient

  # Type 5: Forensic Deep-Dive
  - question: What other TA14-353A malware components are present on this system?
    context: TA14-353A campaigns typically deploy multiple malware components for comprehensive access.
    range: -4h
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          alert.signature|contains: "TA14-353A"
        condition: selection
      fields:
        - alert.signature
        - rule.name
        - dst_port

  - question: Are there signs of the backdoor attempting to establish persistence?
    context: Advanced backdoors implement persistence mechanisms to survive system reboots.
    range: +2h
    query: |
      aggregation: false
      logsource:
        category: process_creation
      detection:
        selection:
          host.ip|expand: '%src_ip%'
          Image|contains:
            - "schtasks"
            - "reg.exe"
            - "services.exe"
        condition: selection
      fields:
        - Image
        - CommandLine
        - User

  # Type 6: Enterprise Correlation
  - question: How many systems across the enterprise are communicating on port 488?
    context: Port 488 usage across multiple systems indicates widespread backdoor deployment.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          dst_port: 488
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - bytes_toserver