name: ET MALWARE US-CERT TA14-353A Lightweight Backdoor 6
id: 22020012
description: |
  Detects network traffic to port 488 matching US-CERT TA14-353A lightweight backdoor signature variant 6.
  This specific byte pattern on port 488 indicates communication with a known backdoor implant.
  Similar to variant 2 but with different signature, suggesting backdoor evolution or configuration changes.
type: detection
detection_id: 2020012
detection_category:
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  # Type 1: Artifact Analysis
  - question: What is the exact byte pattern difference between this variant 6 and other port 488 backdoors?
    context: Signature variations help identify different backdoor versions, configurations, or campaign phases.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - payload
        - payload_printable
        - alert.signature

  - question: What was the complete network payload sent to port 488 in this communication?
    context: Full payload analysis reveals the backdoor's command structure and operational parameters.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - payload
        - flow_id
        - packet_info.payload_len

  - question: How does this signature pattern correlate with the backdoor's functional capabilities?
    context: Understanding signature meaning helps assess the backdoor's intended operations and threat level.
    range: -1h
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_port: 488
        condition: selection
      fields:
        - alert.signature
        - rule.name
        - bytes_toserver

  # Type 2: Triage Assessment
  - question: Is this a new deployment of the variant 6 backdoor on this system?
    context: First-time variant detection may indicate fresh compromise or backdoor upgrade.
    range: -30d
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          rule.name|expand: '%rule.name%'
        condition: selection
      fields:
        - src_ip
        - dst_ip

  - question: Has this system shown other port 488 backdoor variants previously?
    context: Multiple variants on one system suggest persistent compromise or backdoor evolution.
    range: -7d
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_port: 488
          alert.signature|contains: "TA14-353A"
        condition: selection
      fields:
        - alert.signature
        - rule.name
        - dst_ip

  # Type 3: Activity Context
  - question: What process initiated this port 488 backdoor communication?
    context: Identifying the host process helps understand the backdoor's deployment and execution method.
    range: -30m
    query: |
      aggregation: false
      logsource:
        category: process_creation
      detection:
        selection:
          host.ip|expand: '%src_ip%'
        condition: selection
      fields:
        - Image
        - CommandLine
        - ProcessGuid
        - ParentImage

  - question: What network activity preceded this backdoor variant 6 activation?
    context: Understanding the attack sequence helps identify how this specific variant was deployed.
    range: -4h
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - service
        - bytes_toserver

  - question: Were there file system modifications before this variant 6 backdoor appeared?
    context: File changes may indicate variant installation, updates, or configuration modifications.
    range: -2h
    query: |
      aggregation: false
      logsource:
        category: file_event
      detection:
        selection:
          host.ip|expand: '%src_ip%'
        condition: selection
      fields:
        - TargetFilename
        - file.hash.md5
        - ProcessGuid

  # Type 4: Impact Assessment
  - question: Has this variant 6 backdoor established persistent command and control communications?
    context: Successful backdoor deployment enables ongoing unauthorized access through port 488.
    range: +6h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_port: 488
        condition: selection
      fields:
        - dst_ip
        - bytes_toserver
        - bytes_toclient
        - duration

  - question: What commands or data have been transmitted through this variant 6 channel?
    context: Communication analysis helps assess the scope of unauthorized access and potential data theft.
    range: +12h
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          community_id|expand: '%community_id%'
        condition: selection
      fields:
        - bytes_toserver
        - bytes_toclient
        - pkts_toserver
        - pkts_toclient

  # Type 5: Forensic Deep-Dive
  - question: What is the relationship between variant 6 and other TA14-353A components on this system?
    context: Understanding malware component relationships helps assess the full compromise scope.
    range: -8h
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          alert.signature|contains: "TA14-353A"
        condition: selection
      fields:
        - alert.signature
        - rule.name
        - dst_port

  - question: Are there signs of this backdoor variant attempting to establish persistence mechanisms?
    context: Advanced backdoors implement persistence to maintain access across system reboots and updates.
    range: +4h
    query: |
      aggregation: false
      logsource:
        category: process_creation
      detection:
        selection:
          host.ip|expand: '%src_ip%'
          Image|contains:
            - "schtasks"
            - "reg.exe"
            - "sc.exe"
        condition: selection
      fields:
        - Image
        - CommandLine
        - User

  # Type 6: Enterprise Correlation
  - question: How many systems across the enterprise are running this specific variant 6 backdoor?
    context: Variant distribution analysis helps understand campaign targeting and deployment strategies.
    range: -48h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          rule.name|expand: '%rule.name%'
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - alert.signature

  - question: Is there a pattern in variant 6 deployment across different network segments?
    context: Understanding deployment patterns helps identify attack vectors and prioritize containment efforts.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          dst_port: 488
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - bytes_toserver