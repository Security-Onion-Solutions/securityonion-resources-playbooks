name: ET WEB_CLIENT Proxy - BurpSuite PortSwigger Proxy Certificate Seen
id: 22021942
description: |
  Detects BurpSuite PortSwigger proxy certificate in TLS traffic, indicating web application security testing or penetration testing activity.
  May represent legitimate security testing by authorized personnel or malicious reconnaissance and attack preparation.
  BurpSuite is a professional web application security testing platform commonly used for vulnerability assessments.
type: detection
detection_id: 2021942
detection_category:
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  # Type 1: Artifact Analysis
  - question: What are the complete PortSwigger certificate details for this BurpSuite proxy connection?
    context: Certificate analysis reveals BurpSuite configuration and helps determine if this represents legitimate security testing.
    query: |
      aggregation: false
      logsource:
        category: network
        service: ssl
      detection:
        selection:
          community_id|expand: '%community_id%'
        condition: selection
      fields:
        - tls.server.certificate.subject
        - tls.server.certificate.issuer
        - tls.server.certificate.not_valid_after
        - tls.server.certificate.serial_number

  - question: What was the specific TLS handshake pattern for this BurpSuite proxy session?
    context: Understanding TLS negotiation confirms proxy interception and identifies the scope of web application testing.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - tls.version
        - tls.cipher_suite
        - payload_printable

  # Type 2: Triage Assessment
  - question: Is this BurpSuite activity occurring during authorized penetration testing periods?
    context: Legitimate security testing typically follows scheduled assessment windows and documented procedures.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: ssl
      detection:
        selection:
          dst_ip|expand: '%dst_ip%'
          tls.server.certificate.issuer|contains: "PortSwigger"
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - dst_port

  - question: Is the source system associated with authorized security testing personnel or infrastructure?
    context: Distinguishes between legitimate penetration testing tools and unauthorized attack preparation activities.
    range: -7d
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - proto

  # Type 3: Activity Context
  - question: What web applications are being analyzed through this BurpSuite proxy session?
    context: Identifies the target scope of security testing or potential attack reconnaissance activities.
    range: +/-15m
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
        condition: selection
      fields:
        - url.full
        - http.request.method
        - http.response.status_code
        - user_agent.original

  - question: What initiated this BurpSuite proxy-intercepted web session?
    context: Understanding session origin helps determine if this is manual testing or automated vulnerability scanning.
    range: -30m
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - proto
        - conn_state

  # Type 4: Impact Assessment
  - question: What sensitive applications or data have been accessed through this BurpSuite proxy?
    context: Determines if critical systems were exposed to security testing or potential attack reconnaissance.
    range: +1h
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - url.path
        - http.request.method
        - http.response.status_code
        - http.response.body.bytes

  - question: Has this BurpSuite session established ongoing web application analysis?
    context: Persistent proxy sessions indicate comprehensive security testing or sustained reconnaissance activity.
    range: +2h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - duration
        - orig_bytes
        - resp_bytes

  # Type 5: Forensic Deep-Dive
  - question: What specific BurpSuite testing techniques or attack payloads were used?
    context: Detailed analysis reveals whether this is basic reconnaissance or advanced penetration testing with exploit attempts.
    range: +30m
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - http.request.body.content
        - user_agent.original
        - url.query

  - question: Are there indicators of BurpSuite software installation or execution on the source system?
    context: Confirms local BurpSuite installation versus traffic routing through external testing infrastructure.
    range: -1h
    query: |
      aggregation: false
      logsource:
        category: process_creation
      detection:
        selection:
          Hostname|expand: '%src_ip%'
          Image|contains:
            - "burp"
            - "java"
        condition: selection
      fields:
        - Image
        - CommandLine
        - User
        - ParentImage

  # Type 6: Enterprise Correlation
  - question: Are multiple systems across the network using BurpSuite proxies concurrently?
    context: Coordinated BurpSuite usage may indicate organized penetration testing or distributed attack preparation.
    range: +/-24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: ssl
      detection:
        selection:
          tls.server.certificate.issuer|contains: "PortSwigger"
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - dst_port

  - question: Is this part of broader security testing tool usage patterns in the enterprise?
    context: Helps determine if this represents authorized security assessment or coordinated attack reconnaissance campaign.
    range: +/-48h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          rule.name|contains:
            - "Proxy"
            - "BurpSuite"
            - "PortSwigger"
            - "ZAP"
            - "Fiddler"
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - rule.name