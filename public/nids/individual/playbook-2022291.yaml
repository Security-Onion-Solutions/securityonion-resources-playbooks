name: ET EXPLOIT Juniper ScreenOS telnet Backdoor Default Password Attempt
id: 22022291
description: |
  Detects attempts to exploit CVE-2015-7755, a backdoor in Juniper ScreenOS devices.
  The backdoor allows unauthorized access using a hardcoded password.
  May trigger on legitimate telnet authentication attempts with similar patterns.
type: detection
detection_id: 2022291
detection_category:
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  # Type 1: Artifact Analysis
  - question: What was the exact backdoor authentication pattern detected in the telnet session?
    context: The specific byte pattern reveals the hardcoded backdoor password attempt.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - payload
        - rule.name
        - alert.signature

  - question: What Juniper device was targeted and what service was accessed?
    context: Identifying the target device helps assess the scope of potential compromise.
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          community_id|expand: '%community_id%'
          dst_port: 23
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - src_ip
        - bytes_toserver

  # Type 2: Triage Assessment
  - question: Is this telnet access from an authorized network administrator?
    context: Legitimate administrators may use telnet for device management from known subnets.
    range: -7d
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_port: 23
        condition: selection
      fields:
        - dst_ip
        - connection_state
        - duration

  - question: Does this activity align with scheduled maintenance windows?
    context: Network device access often occurs during planned maintenance periods.
    range: -1h/+1h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          dst_ip|expand: '%dst_ip%'
          dst_port|contains:
            - 22
            - 23
            - 80
            - 443
        condition: selection
      fields:
        - src_ip
        - dst_port
        - connection_state

  # Type 3: Activity Context
  - question: What reconnaissance activity preceded this backdoor attempt?
    context: Attackers often scan for Juniper devices before exploitation attempts.
    range: -30m
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_port|contains:
            - 22
            - 23
            - 80
            - 443
            - 8080
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - connection_state
        - bytes_toserver

  - question: What other network devices has this source IP targeted?
    context: Lateral movement often involves targeting multiple network infrastructure devices.
    range: -2h/+30m
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_port|contains:
            - 22
            - 23
            - 161
            - 443
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - connection_state

  # Type 4: Impact Assessment
  - question: Was the backdoor authentication successful?
    context: Successful authentication indicates potential device compromise and configuration access.
    range: +15m
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          community_id|expand: '%community_id%'
        condition: selection
      fields:
        - connection_state
        - duration
        - bytes_toclient
        - bytes_toserver

  - question: What configuration changes or commands were executed post-authentication?
    context: Successful backdoor access may lead to device reconfiguration or data exfiltration.
    range: +30m
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
          dst_port: 23
        condition: selection
      fields:
        - bytes_toserver
        - bytes_toclient
        - duration
        - connection_state

  # Type 5: Forensic Deep-Dive
  - question: Are there indicators of automated scanning tools or exploit frameworks?
    context: The timing and pattern of attempts can reveal automated exploitation tools.
    range: -1h/+1h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          rule.category|contains:
            - "EXPLOIT"
            - "SCAN"
        condition: selection
      fields:
        - rule.name
        - dst_ip
        - dst_port

  - question: What is the geolocation and reputation of the source IP address?
    context: External or suspicious IP addresses indicate potential threat actor activity.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - src_ip
        - geoip.country_name
        - threat_intel.ioc_value

  # Type 6: Enterprise Correlation
  - question: Are other Juniper devices in the network experiencing similar backdoor attempts?
    context: Coordinated attacks often target multiple devices of the same vendor or model.
    range: -2h/+2h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          rule.name|contains: "Juniper"
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - rule.name

  - question: Is this part of a broader infrastructure targeting campaign?
    context: Network device compromises often indicate advanced persistent threat activity.
    range: -24h/+2h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          rule.category|contains:
            - "EXPLOIT"
            - "MALWARE"
        condition: selection
      fields:
        - rule.name
        - dst_ip
        - rule.category