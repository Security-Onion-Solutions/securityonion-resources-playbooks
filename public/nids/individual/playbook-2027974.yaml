name: ET EXPLOIT HiSilicon DVR - Default Application Backdoor Password
id: 22027974
description: |
  Detects attempts to use default backdoor password "I0TO5Wv9" on HiSilicon DVR application services.
  This indicates exploitation of hardcoded backdoor credentials in DVR firmware.
  Legitimate access would not use manufacturer backdoor passwords on ports 554 or 9527.
type: detection
detection_id: 2027974
detection_category:
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  # Type 1: Artifact Analysis
  - question: What was the exact backdoor authentication pattern detected?
    context: Understanding the specific backdoor credential usage confirms HiSilicon DVR exploitation and attack methodology.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - rule.name
        - payload
        - src_ip
        - dst_ip
        - dst_port

  - question: Which specific service port was targeted with the backdoor password?
    context: Port 554 (RTSP) or 9527 indicate different attack vectors and potential impact on DVR functionality.
    range: -10m
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
          dst_port|contains:
            - 554
            - 9527
        condition: selection
      fields:
        - dst_port
        - community_id
        - bytes_in
        - bytes_out

  # Type 2: Triage Assessment
  - question: Is this DVR system supposed to have these application services exposed?
    context: Legitimate DVR deployment might not require external access to RTSP or management ports.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          dst_ip|expand: '%dst_ip%'
          dst_port|contains:
            - 554
            - 9527
        condition: selection
      fields:
        - src_ip
        - dst_port
        - bytes_in

  - question: Are there any authorized users or systems that should access this DVR?
    context: Helps distinguish between legitimate management access and malicious exploitation attempts.
    range: -7d
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          dst_ip|expand: '%dst_ip%'
          dst_port|contains:
            - 554
            - 9527
            - 80
            - 443
        condition: selection
      fields:
        - src_ip
        - dst_port

  # Type 3: Activity Context
  - question: What reconnaissance activity preceded this backdoor exploitation attempt?
    context: Understanding the attack sequence helps identify whether this is targeted or automated scanning.
    range: -1h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
        condition: selection
      fields:
        - dst_port
        - community_id

  - question: What other IoT devices or services has this attacker probed?
    context: Multiple IoT access attempts indicate automated botnet recruitment or targeted IoT exploitation campaign.
    range: -2h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_port|contains:
            - 23
            - 80
            - 554
            - 8080
            - 9527
        condition: selection
      fields:
        - dst_ip
        - dst_port

  - question: Was this backdoor attempt part of a series of authentication attempts?
    context: Multiple authentication patterns help identify attack tools and determine persistence of exploitation efforts.
    range: -30m
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
          dst_port|expand: '%dst_port%'
        condition: selection
      fields:
        - bytes_in
        - bytes_out
        - community_id

  # Type 4: Impact Assessment
  - question: Was the backdoor authentication successful?
    context: Successful authentication indicates full DVR compromise requiring immediate incident response.
    range: -15m
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          community_id|expand: '%community_id%'
        condition: selection
      fields:
        - bytes_in
        - bytes_out
        - duration

  - question: Are there signs of video stream access or configuration modification?
    context: Successful exploitation may lead to unauthorized surveillance access or system reconfiguration.
    range: -30m
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          dst_ip|expand: '%dst_ip%'
          dst_port: 554
        condition: selection
      fields:
        - src_ip
        - bytes_out
        - duration

  # Type 5: Forensic Deep-Dive
  - question: What specific actions were performed after successful backdoor authentication?
    context: Post-exploitation activity reveals attacker intent and helps assess full scope of compromise.
    range: -1h
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
        condition: selection
      fields:
        - dst_port
        - bytes_in
        - bytes_out
        - duration

  - question: Has the compromised DVR been configured for malicious purposes?
    context: Compromised DVRs may be used for botnet participation, cryptocurrency mining, or surveillance.
    range: -2h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%dst_ip%'
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - bytes_out

  # Type 6: Enterprise Correlation
  - question: Are other HiSilicon DVR systems being targeted with similar backdoor attacks?
    context: Multiple DVR exploitation attempts indicate coordinated campaign requiring enterprise-wide response.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          rule.name|contains:
            - 'HiSilicon'
            - 'DVR'
            - 'Backdoor'
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - rule.name

  - question: Is this attacker targeting other IoT devices with default or backdoor credentials?
    context: Understanding campaign scope helps identify other vulnerable devices and prioritize security response.
    range: -6h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          rule.name|contains:
            - 'Default'
            - 'Backdoor'
            - 'IoT'
        condition: selection
      fields:
        - dst_ip
        - rule.name