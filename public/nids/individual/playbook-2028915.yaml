name: ET MALWARE Instagram Like Bot (like4u) CnC Activity M1
id: 22028915
description: |
  Detects Instagram Like Bot (like4u) malware communicating with command and control servers.
  Identifies GET requests to specific Instagram native client endpoints used by bot automation tools.
  May occasionally trigger on legitimate Instagram API usage but typically indicates unauthorized automation.
type: detection
detection_id: 2028915
detection_category:
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  # Type 1: Artifact Analysis
  - question: What was the complete HTTP request pattern that triggered this alert?
    context: Understanding the exact URI and parameters reveals the specific bot functionality being accessed.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - http.request.method
        - url.full
        - http.request.headers
        - http.user_agent

  - question: What specific Instagram bot operation was being performed?
    context: The URI pattern indicates whether this is likes manipulation, status checking, or login verification.
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          community_id|expand: '%community_id%'
        condition: selection
      fields:
        - url.path
        - url.query
        - http.request.body.content

  # Type 2: Triage Assessment
  - question: Is this system authorized to use Instagram automation tools?
    context: Some organizations may legitimately use Instagram marketing automation with proper authorization.
    range: -7d
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          url.path|contains:
            - '/client/instagram'
            - '/api/instagram'
        condition: selection
      fields:
        - src_ip
        - url.domain
        - http.user_agent

  - question: Does this activity align with normal business hours and user behavior?
    context: Bot activity often occurs outside normal business hours or shows automated patterns.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_port|contains:
            - 80
            - 443
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - connection.bytes_sent
        - connection.bytes_received

  # Type 3: Activity Context
  - question: What process initiated this Instagram bot communication?
    context: Identifying the parent process helps determine if this is malware or legitimate software.
    range: -15m
    query: |
      aggregation: false
      logsource:
        category: process_creation
      detection:
        selection:
          host.ip|expand: '%src_ip%'
        condition: selection
      fields:
        - process.name
        - process.command_line
        - process.parent.name
        - User

  - question: What other network connections occurred around the same time?
    context: Bot malware often makes multiple connections for updates, configuration, or data exfiltration.
    range: +/-15m
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - connection.protocol

  # Type 4: Impact Assessment
  - question: Has the bot successfully authenticated to Instagram services?
    context: Successful authentication indicates active account compromise and potential reputation damage.
    range: +2h
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          http.response.status_code|contains:
            - 200
            - 201
        condition: selection
      fields:
        - url.path
        - http.response.status_code
        - http.response.body.content

  - question: What Instagram accounts or data has been accessed?
    context: Understanding the scope of account access helps assess potential business impact.
    range: +4h
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          url.domain|contains:
            - 'instagram.com'
            - 'cdninstagram.com'
        condition: selection
      fields:
        - url.path
        - http.request.method
        - http.response.status_code

  # Type 5: Forensic Deep-Dive
  - question: What specific Instagram Like Bot variant is being used?
    context: Different bot variants have different capabilities and persistence mechanisms.
    query: |
      aggregation: false
      logsource:
        category: file_event
      detection:
        selection:
          host.ip|expand: '%src_ip%'
          file.hash.md5|contains:
            - '00a0737576d711a8c3a0fdf48fef035a'
            - '673652533091319b83a02fd82026f826'
        condition: selection
      fields:
        - file.path
        - file.name
        - file.hash.md5
        - file.hash.sha256

  - question: Are there signs of credential harvesting or account takeover?
    context: Instagram bots often steal credentials or take over accounts for malicious purposes.
    range: +24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          http.request.method: 'POST'
          url.path|contains:
            - '/login'
            - '/auth'
            - '/session'
        condition: selection
      fields:
        - url.full
        - http.request.body.content
        - http.response.status_code

  # Type 6: Enterprise Correlation
  - question: Are other systems in the network showing similar Instagram bot activity?
    context: Bot malware often spreads laterally or is part of coordinated campaigns.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          rule.name|contains: 'Instagram Like Bot'
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - rule.name

  - question: Is this part of a broader social media manipulation campaign?
    context: Instagram bots are often part of larger social media influence operations.
    range: -7d
    query: |
      aggregation: true
      logsource:
        category: network
        service: dns
      detection:
        selection:
          host.ip|expand: '%src_ip%'
          dns.query.name|contains:
            - 'facebook.com'
            - 'twitter.com'
            - 'tiktok.com'
            - 'linkedin.com'
        condition: selection
      fields:
        - dns.query.name
        - dns.resolved_ip