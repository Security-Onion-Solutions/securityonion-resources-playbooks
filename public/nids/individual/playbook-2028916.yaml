name: ET MALWARE Instagram Like Bot (like4u) CnC Activity M2
id: 22028916
description: |
  Detects Instagram Like Bot (like4u) malware performing login operations with status checking.
  Identifies POST requests to Instagram native client login endpoints used for account authentication.
  Typically indicates unauthorized automation or account compromise attempts.
type: detection
detection_id: 2028916
detection_category:
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  # Type 1: Artifact Analysis
  - question: What login credentials or authentication data was transmitted?
    context: Understanding the authentication payload reveals potential credential theft or account compromise.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - http.request.method
        - url.full
        - http.request.body.content
        - http.request.headers

  - question: What specific login status information was being requested?
    context: The login status endpoint reveals what account information the bot is trying to verify.
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          community_id|expand: '%community_id%'
        condition: selection
      fields:
        - url.path
        - url.query
        - http.response.body.content
        - http.response.status_code

  # Type 2: Triage Assessment
  - question: Is this system authorized for Instagram account management?
    context: Some organizations may legitimately manage multiple Instagram accounts for marketing purposes.
    range: -30d
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          url.domain|contains:
            - 'instagram.com'
            - 'facebook.com'
        condition: selection
      fields:
        - src_ip
        - url.domain
        - http.user_agent
        - http.request.method

  - question: Does the timing suggest automated versus human behavior?
    context: Bot activity typically shows consistent intervals unlike human interaction patterns.
    range: -4h
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          http.request.method: 'POST'
        condition: selection
      fields:
        - src_ip
        - url.path
        - http.request.method

  # Type 3: Activity Context
  - question: What application or process initiated this login attempt?
    context: Identifying the source process helps distinguish between malware and legitimate applications.
    range: -15m
    query: |
      aggregation: false
      logsource:
        category: process_creation
      detection:
        selection:
          host.ip|expand: '%src_ip%'
        condition: selection
      fields:
        - process.name
        - process.command_line
        - process.parent.name
        - User

  - question: What preceded this login attempt in the network traffic?
    context: Understanding the sequence helps identify if this is part of a larger attack chain.
    range: -30m
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_port|contains:
            - 80
            - 443
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - connection.protocol
        - connection.state

  - question: Are there multiple concurrent login attempts from this source?
    context: Multiple simultaneous logins suggest automated credential stuffing or account takeover.
    range: +/-15m
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          url.path|contains: '/login'
        condition: selection
      fields:
        - dst_ip
        - url.path
        - http.response.status_code

  # Type 4: Impact Assessment
  - question: Were the login attempts successful?
    context: Successful logins indicate active account compromise requiring immediate response.
    range: +1h
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          http.response.status_code|contains:
            - 200
            - 201
            - 302
        condition: selection
      fields:
        - url.path
        - http.response.status_code
        - http.response.headers

  - question: What Instagram account activities occurred after login?
    context: Post-login activity reveals the extent of account compromise and malicious actions taken.
    range: +4h
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          url.domain|contains: 'instagram.com'
        condition: selection
      fields:
        - url.path
        - http.request.method
        - http.response.status_code

  # Type 5: Forensic Deep-Dive
  - question: What Instagram Like Bot malware variant is present on the system?
    context: Identifying the specific malware helps understand its capabilities and removal requirements.
    query: |
      aggregation: false
      logsource:
        category: file_event
      detection:
        selection:
          host.ip|expand: '%src_ip%'
          file.hash.md5|contains:
            - '00a0737576d711a8c3a0fdf48fef035a'
            - '673652533091319b83a02fd82026f826'
        condition: selection
      fields:
        - file.path
        - file.name
        - file.hash.md5
        - file.hash.sha256

  - question: Are there signs of credential harvesting or data exfiltration?
    context: Bot malware often steals credentials or exfiltrates account data for monetization.
    range: +24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          connection.bytes_sent: '>1000'
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - connection.bytes_sent
        - connection.bytes_received

  # Type 6: Enterprise Correlation
  - question: Are other systems showing similar Instagram bot login activity?
    context: Bot infections often spread across networks or are part of coordinated campaigns.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          rule.name|contains: 'Instagram Like Bot'
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - rule.name

  - question: Is this part of a broader social media account compromise campaign?
    context: Instagram bot activity is often part of larger social media manipulation operations.
    range: -7d
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          url.path|contains: '/login'
          url.domain|contains:
            - 'facebook.com'
            - 'twitter.com'
            - 'tiktok.com'
        condition: selection
      fields:
        - url.domain
        - http.response.status_code