name: ET MALWARE Platinum APT - Titanium Hardcoded String Observed
id: 22028960
description: |
  Detects Titanium malware communications containing hardcoded identifier strings used by Platinum APT.
  The specific string "06xwsrdrub2i84n6map3li3vz3h9bh4vfgcw" is unique to Titanium malware and indicates
  active C2 communication. This hardcoded string has no legitimate use cases.
type: detection
detection_id: 2028960
detection_category:
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  # Type 1: Artifact Analysis
  - question: What was the complete POST request containing the Titanium hardcoded string?
    context: Understanding the full request structure reveals the malware's data exfiltration or command protocol.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - http.request.method
        - url.full
        - http.request.headers
        - http.request.body.content

  - question: How was the hardcoded string "06xwsrdrub2i84n6map3li3vz3h9bh4vfgcw" embedded in the communication?
    context: The positioning and encoding of this identifier reveals the specific Titanium variant and communication protocol.
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
          community_id|expand: '%community_id%'
        condition: selection
      fields:
        - http.request.body.content
        - url.path
        - http.request.headers

  # Type 2: Triage Assessment
  - question: Could this hardcoded string appear in any legitimate application or service?
    context: This specific 38-character string is unique to Titanium malware with no known legitimate uses.
    range: -30d
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          http.request.method: "POST"
        condition: selection
      fields:
        - dst_ip
        - url.path
        - http.request.body.content

  - question: Is this system authorized for any development or testing activities that might generate similar strings?
    context: Confirming the system's role helps eliminate any possibility of false positive from development activities.
    range: -7d
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - bytes_out

  # Type 3: Activity Context
  - question: What process generated the POST request containing the hardcoded Titanium string?
    context: Identifying the malicious process helps understand the infection vector and current execution context.
    range: -15m
    query: |
      aggregation: false
      logsource:
        category: process_creation
      detection:
        selection:
          host.ip|expand: '%src_ip%'
        condition: selection
      fields:
        - Image
        - CommandLine
        - ParentImage
        - ProcessGuid

  - question: What network activity led to this hardcoded string communication?
    context: Understanding the sequence helps identify whether this is initial infection or ongoing C2 activity.
    range: -1h
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - bytes_in
        - bytes_out

  - question: What was the frequency and timing of communications containing this hardcoded identifier?
    context: The communication pattern reveals operational tempo and potential data exfiltration schedules.
    range: -24h
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
          http.request.method: "POST"
        condition: selection
      fields:
        - url.path
        - http.request.body.content
        - http.response.status_code

  # Type 4: Impact Assessment
  - question: What data was transmitted along with the hardcoded Titanium identifier?
    context: The hardcoded string may be used to authenticate or identify exfiltrated data packets.
    range: +30m
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
          http.request.method: "POST"
        condition: selection
      fields:
        - http.request.body.content
        - bytes_out
        - http.response.status_code

  - question: Did the C2 server respond with commands after receiving the hardcoded string authentication?
    context: Successful authentication via the hardcoded string may trigger command delivery or additional payload downloads.
    range: +1h
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
        condition: selection
      fields:
        - bytes_in
        - bytes_out
        - duration

  # Type 5: Forensic Deep-Dive
  - question: What files contain or reference this hardcoded Titanium identifier string?
    context: The string may be embedded in malware files, configuration data, or exfiltrated documents.
    range: -1h
    query: |
      aggregation: false
      logsource:
        category: file_event
      detection:
        selection:
          host.ip|expand: '%src_ip%'
        condition: selection
      fields:
        - TargetFilename
        - file.hash.md5
        - ProcessGuid

  - question: Are there registry modifications or persistence mechanisms associated with this Titanium variant?
    context: The hardcoded string may be part of a specific Titanium build with unique persistence characteristics.
    range: -2h
    query: |
      aggregation: false
      logsource:
        category: registry_event
      detection:
        selection:
          host.ip|expand: '%src_ip%'
        condition: selection
      fields:
        - TargetObject
        - Details
        - ProcessGuid

  - question: What other unique Titanium artifacts are present on this compromised system?
    context: Additional Titanium indicators help confirm the malware variant and assess full compromise scope.
    range: +2h
    query: |
      aggregation: false
      logsource:
        category: process_creation
      detection:
        selection:
          host.ip|expand: '%src_ip%'
        condition: selection
      fields:
        - Image
        - CommandLine
        - User
        - ProcessGuid

  # Type 6: Enterprise Correlation
  - question: Are other systems communicating with the same C2 infrastructure using this hardcoded string?
    context: The unique identifier may be campaign-specific, helping identify all systems compromised in this operation.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          dst_ip|expand: '%dst_ip%'
          http.request.method: "POST"
        condition: selection
      fields:
        - src_ip
        - url.path
        - http.request.body.content

  - question: Is this hardcoded string part of a broader Platinum APT campaign targeting the organization?
    context: Correlating with other Platinum indicators helps understand the full scope and timeline of the campaign.
    range: -7d
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          rule.name|contains:
            - "PLATINUM"
            - "Titanium"
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - rule.name