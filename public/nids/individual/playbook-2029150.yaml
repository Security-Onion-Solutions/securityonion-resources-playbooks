name: ET JA3 Hash - Trojan.AndroidOS.Jocker.snt 1
id: 22029150
description: |
  Detects Android Jocker trojan based on specific JA3 TLS fingerprint.
  Jocker is Android malware that subscribes victims to premium services and steals SMS messages.
  This signature identifies the malware's distinctive TLS handshake pattern during C2 communication.
type: detection
detection_id: 2029150
detection_category:
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  # Type 1: Artifact Analysis
  - question: What TLS connection details match the Jocker trojan JA3 fingerprint?
    context: The specific JA3 hash identifies Jocker's TLS implementation and confirms malware presence.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - tls.ja3
        - tls.ja3s
        - tls.version
        - tls.server.certificate.subject

  - question: What is the complete TLS certificate chain for this connection?
    context: Certificate details reveal the C2 infrastructure and may indicate shared hosting or compromised certificates.
    query: |
      aggregation: false
      logsource:
        category: network
        service: ssl
      detection:
        selection:
          community_id|expand: '%community_id%'
        condition: selection
      fields:
        - tls.server.certificate.subject
        - tls.server.certificate.issuer
        - tls.server.certificate.serial_number
        - tls.server.certificate.not_after

  # Type 2: Triage Assessment
  - question: Is this TLS connection from a legitimate Android application?
    context: Determines if the JA3 fingerprint represents actual Jocker malware or a false positive from legitimate apps.
    range: -7d
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_port|contains:
            - 443
            - 8443
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - proto
        - bytes_toserver

  - question: Does this mobile device show patterns of normal application usage?
    context: Regular app store connections and updates indicate legitimate device usage versus dedicated malware operation.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: dns
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dns.query.name|contains:
            - play.google.com
            - android.com
            - googleapis.com
        condition: selection
      fields:
        - dns.query.name
        - dns.resolved_ip
        - dns.query.type_name

  # Type 3: Activity Context
  - question: What network activity preceded this Jocker C2 connection?
    context: Understanding initial infection vector helps identify how Jocker was installed on the device.
    range: -30m
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - proto
        - bytes_toserver
        - bytes_toclient

  - question: Are there DNS queries to suspicious domains from this device?
    context: Jocker often contacts multiple C2 domains and may perform domain generation algorithm lookups.
    range: -1h
    query: |
      aggregation: true
      logsource:
        category: network
        service: dns
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - dns.query.name
        - dns.resolved_ip
        - dns.query.type_name

  - question: What other TLS connections has this device established recently?
    context: Multiple encrypted connections may indicate additional malware components or data exfiltration channels.
    range: -2h
    query: |
      aggregation: true
      logsource:
        category: network
        service: ssl
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - dst_ip
        - tls.server.certificate.subject
        - tls.ja3

  # Type 4: Impact Assessment
  - question: Has this device transmitted sensitive data after the C2 connection?
    context: Jocker steals SMS messages and personal data, requiring assessment of information disclosure.
    range: +2h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          bytes_toserver: ">5000"
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - bytes_toserver
        - proto

  - question: Are there signs of premium service subscription fraud from this device?
    context: Jocker's primary purpose is fraudulent premium service subscriptions requiring financial impact assessment.
    range: +24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_port|contains:
            - 80
            - 443
        condition: selection
      fields:
        - dst_ip
        - bytes_toserver
        - bytes_toclient

  # Type 5: Forensic Deep-Dive
  - question: What is the complete Jocker campaign timeline for this device?
    context: Full infection timeline helps understand malware evolution and guides complete remediation.
    range: -7d
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          rule.name|contains: Jocker
        condition: selection
      fields:
        - rule.name
        - rule.category
        - dst_ip
        - community_id

  - question: What specific Jocker variant indicators are present in the network traffic?
    context: Different Jocker variants have distinct behaviors and C2 patterns requiring variant-specific response.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: ssl
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          tls.ja3|contains: 2f514a024266e9e8d11f10e779168579
        condition: selection
      fields:
        - tls.server.certificate.subject
        - dst_ip
        - tls.ja3s

  # Type 6: Enterprise Correlation
  - question: Are other mobile devices in the network showing similar Jocker indicators?
    context: Jocker campaigns often target multiple devices simultaneously through malicious app stores or phishing.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          rule.name|contains: Jocker
          dst_ip|expand: '%dst_ip%'
        condition: selection
      fields:
        - src_ip
        - rule.category
        - community_id

  - question: Is this part of a broader mobile malware campaign affecting the organization?
    context: Multiple mobile threats may indicate targeted campaign requiring coordinated mobile device management response.
    range: -7d
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          rule.category|contains:
            - trojan-activity
            - malware
          rule.name|contains: Android
        condition: selection
      fields:
        - src_ip
        - rule.name
        - dst_ip