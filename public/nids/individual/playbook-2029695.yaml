name: ET PHISHING Fake World Health Organization COVID-19 Portal
id: 22029695
description: |
  Detects fake WHO COVID-19 phishing pages designed to steal credentials.
  These pages mimic legitimate WHO coronavirus information but contain account verification prompts.
  Legitimate WHO pages would not request account verification for COVID-19 information.
type: detection
detection_id: 2029695
detection_category:
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  - question: What is the complete content of the fake WHO COVID-19 phishing page?
    context: Full page content reveals the exact phishing technique and credential harvesting methods used.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - http.request.body.content
        - http.response.body.content
        - url.full
        - http.request.method

  - question: Is this user typically accessing WHO or health-related websites?
    context: Understanding normal browsing patterns helps determine if this is targeted phishing or opportunistic.
    range: -30d
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          url.domain|contains:
            - 'who.int'
            - 'cdc.gov'
            - 'health'
        condition: selection
      fields:
        - url.domain
        - url.path
        - http.request.method

  - question: How did the user arrive at this fake WHO COVID-19 phishing site?
    context: Understanding the attack vector reveals whether this was email-based, malvertising, or other delivery method.
    range: -30m
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - url.full
        - http.request.referrer
        - user_agent.original

  - question: What web traffic occurred around the time of accessing this phishing site?
    context: Related web requests may reveal the complete attack chain and additional malicious infrastructure.
    range: -15m/+15m
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - url.full
        - http.request.method
        - http.response.status_code
        - http.request.body.content

  - question: Did the user submit credentials or personal information to this phishing site?
    context: Successful credential harvesting requires immediate password reset and account monitoring.
    range: +30m
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
          http.request.method: 'POST'
        condition: selection
      fields:
        - url.full
        - http.request.body.content
        - http.response.status_code

  - question: What DNS queries were made for the phishing domain?
    context: DNS resolution patterns reveal the phishing infrastructure and potential domain generation algorithms.
    range: -30m
    query: |
      aggregation: false
      logsource:
        category: network
        service: dns
      detection:
        selection:
          host.ip|expand: '%src_ip%'
        condition: selection
      fields:
        - dns.query.name
        - dns.resolved_ip
        - dns.query.type_name

  - question: Are there signs of malware installation following the phishing attempt?
    context: COVID-19 phishing often delivers malware payloads in addition to credential harvesting.
    range: +1h
    query: |
      aggregation: false
      logsource:
        category: process_creation
      detection:
        selection:
          host.ip|expand: '%src_ip%'
        condition: selection
      fields:
        - Image
        - CommandLine
        - ParentImage
        - User
        - ProcessGuid

  - question: What files were downloaded or created after accessing the phishing site?
    context: File system changes may indicate secondary payload delivery or data exfiltration preparation.
    range: +2h
    query: |
      aggregation: false
      logsource:
        category: file_event
      detection:
        selection:
          host.ip|expand: '%src_ip%'
          EventID|contains:
            - 11
            - 2
        condition: selection
      fields:
        - TargetFilename
        - Image
        - file.hash.md5
        - file.hash.sha256

  - question: Have other users in the organization accessed this fake WHO phishing infrastructure?
    context: Phishing campaigns often target multiple users simultaneously, requiring organization-wide response.
    range: -24h/+24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          dst_ip|expand: '%dst_ip%'
        condition: selection
      fields:
        - src_ip
        - url.full
        - http.request.method

  - question: Are there other COVID-19 themed phishing attempts across the enterprise?
    context: COVID-19 phishing campaigns use multiple domains and themes, requiring comprehensive threat hunting.
    range: -7d/+1d
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          rule.name|contains:
            - 'COVID'
            - 'Coronavirus'
            - 'WHO'
            - 'PHISHING'
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - rule.name
        - rule.category