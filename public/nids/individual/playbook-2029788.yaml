name: ET PHISHING Canada Revenue Agency COVID-19 Assistance Eligibility Phishing Landing 2020-04-01
id: 22029788
description: |
  Detects French-language Canada Revenue Agency COVID-19 phishing pages designed to steal personal information.
  Contains specific French content "Confirmez Votre Identit" and SIN input fields targeting Canadian victims.
  Legitimate CRA websites use different URL patterns and authentication methods.
type: detection
detection_id: 2029788
detection_category:
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  # Type 1: Artifact Analysis
  - question: What was the complete phishing page content and structure?
    context: Analyzing the full HTML reveals the scope of information being harvested and attack sophistication.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - http.request.body.content
        - http.response.body.content
        - url.full
        - url.path

  - question: What specific personal information fields are being collected?
    context: Understanding targeted data helps assess identity theft risk and victim notification requirements.
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          dst_ip|expand: '%dst_ip%'
          community_id|expand: '%community_id%'
        condition: selection
      fields:
        - http.request.body.content
        - http.request.method
        - url.query

  # Type 2: Triage Assessment
  - question: Is this user accessing legitimate CRA services during business hours?
    context: Legitimate CRA access patterns differ significantly from phishing site interactions.
    range: +/-2h
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          url.domain|contains:
            - 'canada.ca'
            - 'cra-arc.gc.ca'
        condition: selection
      fields:
        - url.domain
        - http.request.method
        - user_agent

  - question: Does this traffic pattern match normal user web browsing behavior?
    context: Phishing victims often show distinct browsing patterns before and after compromise.
    range: -1h
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - url.domain
        - http.response.status_code
        - user_agent

  # Type 3: Activity Context
  - question: How did the user arrive at this phishing site?
    context: Understanding the attack vector helps identify email campaigns or compromised websites.
    range: -30m
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - url.full
        - http.request.referrer
        - user_agent

  - question: What email or social media activity preceded this phishing attempt?
    context: Phishing attacks often begin with malicious emails or social media messages.
    range: -2h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_port|contains:
            - 25
            - 587
            - 993
            - 995
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - service

  # Type 4: Impact Assessment
  - question: Did the user submit personal information to the phishing site?
    context: Successful credential harvesting requires immediate response and user notification.
    range: +15m
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
          http.request.method: 'POST'
        condition: selection
      fields:
        - http.request.body.content
        - http.response.status_code
        - url.path

  - question: What other financial or government sites has this user accessed recently?
    context: Victims may be targeted across multiple platforms, requiring broader account security measures.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          url.domain|contains:
            - 'bank'
            - 'credit'
            - '.gov'
            - 'service'
        condition: selection
      fields:
        - url.domain
        - http.request.method

  # Type 5: Forensic Deep-Dive
  - question: What is the complete phishing infrastructure and hosting details?
    context: Mapping the infrastructure helps identify related campaigns and enables takedown efforts.
    range: -1h
    query: |
      aggregation: false
      logsource:
        category: network
        service: ssl
      detection:
        selection:
          dst_ip|expand: '%dst_ip%'
        condition: selection
      fields:
        - tls.server.certificate.subject
        - tls.server.certificate.issuer
        - tls.server.certificate.serial_number

  - question: What malicious domains and IP addresses are part of this campaign?
    context: Phishing campaigns often use multiple domains and hosting providers for resilience.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: dns
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - dns.query.name
        - dns.resolved_ip
        - dns.query.type_name

  # Type 6: Enterprise Correlation
  - question: Are other users in the organization accessing similar phishing sites?
    context: Phishing campaigns often target multiple users within the same organization.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          rule.name|contains: 'Canada Revenue Agency COVID-19'
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - rule.name

  - question: Is this part of a broader COVID-19 themed phishing campaign?
    context: Threat actors often coordinate themed campaigns targeting current events and concerns.
    range: -7d
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          url.full|contains:
            - 'covid'
            - 'coronavirus'
            - 'pandemic'
            - 'relief'
            - 'assistance'
        condition: selection
      fields:
        - src_ip
        - url.domain
        - url.path