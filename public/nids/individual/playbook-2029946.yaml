name: ET WEB_CLIENT Generic PHP Mailer Accessed on External Compromised Server
id: 22029946
description: |
  Detects access to W0rmVps PRIV8 MAILER PHP interface from external compromised servers.
  This indicates potential spam operations using a private malicious bulk email tool.
  W0rmVps mailer is associated with cybercriminal activities and unauthorized email campaigns.
type: detection
detection_id: 2029946
detection_category:
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  - question: What is the complete W0rmVps PRIV8 MAILER interface content and features accessed?
    context: Understanding the full mailer functionality reveals the scope of potential spam operations and tool capabilities.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - http.response.body.content
        - http.request.method
        - url.full
        - http.response.status_code

  - question: Is this access part of legitimate cybersecurity research or threat intelligence gathering?
    context: Determines if this could be authorized security analysis versus actual malicious usage of the tool.
    range: -6h
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
        condition: selection
      fields:
        - url.path
        - user_agent.original
        - http.request.method

  - question: What other criminal tools or compromised infrastructure has this source IP accessed?
    context: Identifies if this represents systematic reconnaissance of criminal infrastructure by threat actors.
    range: -24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - dst_ip
        - url.path
        - http.request.method

  - question: Are there signs of active email transmission or SMTP connections from the target server?
    context: Determines if the W0rmVps mailer was actively used to send spam emails or malicious campaigns.
    range: +8h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%dst_ip%'
          dst_port|contains:
            - 25
            - 587
            - 465
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - network.bytes_sent

  - question: What configuration changes or data uploads occurred during this W0rmVps session?
    context: Identifies potential recipient list uploads, email template configuration, or mailer customization.
    range: -45m
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          community_id|expand: '%community_id%'
          http.request.method: POST
        condition: selection
      fields:
        - url.path
        - http.request.body.bytes
        - http.response.status_code

  - question: Has this specific W0rmVps mailer instance been accessed by multiple cybercriminals?
    context: Reveals if this is a shared criminal resource or exclusive tool usage by a single threat actor.
    range: -14d
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          dst_ip|expand: '%dst_ip%'
          url.path|contains: 'w0rmvps'
        condition: selection
      fields:
        - src_ip
        - user_agent.original
        - http.request.method

  - question: What authentication bypasses or exploitation methods enabled access to this mailer?
    context: Determines the compromise method used to access the server hosting the W0rmVps tool.
    range: -1h
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          dst_ip|expand: '%dst_ip%'
          url.path|contains:
            - 'login'
            - 'admin'
            - 'exploit'
        condition: selection
      fields:
        - src_ip
        - url.full
        - http.request.method
        - http.response.status_code

  - question: Are there indicators of additional malware or backdoors deployed alongside the W0rmVps mailer?
    context: Identifies the full scope of compromise and other malicious tools requiring investigation.
    range: -4h
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          dst_ip|expand: '%dst_ip%'
          url.path|contains:
            - 'shell'
            - 'backdoor'
            - 'upload'
            - 'cmd'
        condition: selection
      fields:
        - url.path
        - src_ip
        - http.request.method

  - question: What DNS queries revealed the location of this compromised server hosting W0rmVps?
    context: Identifies how the attacker discovered this specific criminal infrastructure resource.
    range: -3h
    query: |
      aggregation: false
      logsource:
        category: network
        service: dns
      detection:
        selection:
          dns.resolved_ip|expand: '%dst_ip%'
        condition: selection
      fields:
        - dns.query.name
        - src_ip
        - dns.query.type_name

  - question: Is this activity part of a larger cybercriminal campaign affecting multiple organizational assets?
    context: Assesses whether this represents isolated reconnaissance or coordinated threat campaign across the network.
    range: -48h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          rule.name|contains: 'PHP Mailer'
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - rule.name

  - question: What volume and patterns of email traffic suggest successful W0rmVps spam campaign execution?
    context: Correlates mailer access with actual spam delivery to assess campaign impact and scope.
    range: +24h
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%dst_ip%'
          dst_port|contains:
            - 25
            - 587
        condition: selection
      fields:
        - dst_ip
        - network.bytes_sent
        - network.packets_sent

  - question: Are there indicators of cryptocurrency or financial fraud operations associated with this W0rmVps usage?
    context: Identifies potential monetization methods and financial crime aspects requiring additional investigation.
    range: -7d
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          url.path|contains:
            - 'bitcoin'
            - 'crypto'
            - 'wallet'
            - 'payment'
        condition: selection
      fields:
        - dst_ip
        - url.path
        - http.request.method