name: GPL DNS named authors attempt
id: 22100256
description: |
  Detects attempts to query the authors.bind TXT record from BIND DNS servers. This query reveals information about the DNS server software version and developers, which can be used for reconnaissance. While not directly exploitable, it indicates DNS fingerprinting activity that may precede targeted attacks.
type: detection
detection_id: 2100256
detection_category:
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  # Type 1: Artifact Analysis
  - question: What was the exact DNS query structure for the authors.bind request?
    context: Understanding the query format confirms this is genuine BIND fingerprinting versus other DNS activity.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - payload
        - payload_printable
        - dns.query.name
        - dns.query.type_name

  - question: What specific BIND server information was being requested?
    context: The authors.bind query reveals DNS server software details used for vulnerability assessment.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - src_ip
        - community_id

  # Type 2: Triage Assessment
  - question: Is this source authorized to perform DNS server enumeration?
    context: Network administrators may legitimately query BIND information for inventory purposes.
    range: -7d
    query: |
      aggregation: true
      logsource:
        category: network
        service: dns
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dns.query.type_name: 'TXT'
        condition: selection
      fields:
        - dns.query.name
        - dst_ip
        - dns.response_code

  - question: Does this activity correlate with documented DNS maintenance or auditing?
    context: Legitimate DNS auditing tools may query BIND metadata during scheduled assessments.
    range: -1d
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_port: 53
        condition: selection
      fields:
        - dst_ip
        - bytes_toserver
        - connection_state

  # Type 3: Activity Context
  - question: What other BIND fingerprinting queries preceded this authors.bind attempt?
    context: Attackers typically query multiple BIND metadata records during reconnaissance phases.
    range: -2h
    query: |
      aggregation: true
      logsource:
        category: network
        service: dns
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dns.query.name|contains:
            - 'version.bind'
            - 'hostname.bind'
            - 'id.server'
        condition: selection
      fields:
        - dns.query.name
        - dns.query.type_name
        - dst_ip

  - question: Were there any DNS zone transfer attempts from this source?
    context: DNS reconnaissance often escalates from metadata queries to zone transfer attempts.
    range: -1h
    query: |
      aggregation: true
      logsource:
        category: network
        service: dns
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dns.query.type_name|contains:
            - 'AXFR'
            - 'IXFR'
        condition: selection
      fields:
        - dns.query.name
        - dns.query.type_name
        - dst_ip

  - question: What triggered this DNS fingerprinting activity?
    context: Understanding the initial trigger helps determine if this is automated scanning or targeted reconnaissance.
    range: -30m
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - dst_ip
        - dst_port
        - app_proto
        - bytes_toserver

  # Type 4: Impact Assessment
  - question: Did the DNS server respond with BIND author information?
    context: A successful response reveals DNS server details that can be used for targeted attacks.
    range: +5m
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%dst_ip%'
          dst_ip|expand: '%src_ip%'
          src_port: 53
        condition: selection
      fields:
        - bytes_toclient
        - connection_state
        - community_id

  - question: Are there signs of follow-up exploitation attempts against the identified BIND version?
    context: Successful fingerprinting may lead to version-specific exploit attempts.
    range: +1h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dst_ip|expand: '%dst_ip%'
          alert.signature|contains: 'DNS'
        condition: selection
      fields:
        - alert.signature
        - alert.severity
        - community_id

  # Type 5: Forensic Deep-Dive
  - question: What DNS reconnaissance tools match this authors.bind query pattern?
    context: Specific tools like dig, nslookup, dnsrecon have distinctive query patterns for BIND fingerprinting.
    range: -15m
    query: |
      aggregation: true
      logsource:
        category: network
        service: dns
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          dns.query.type_name: 'TXT'
        condition: selection
      fields:
        - dns.query.name
        - dst_ip
        - dns.response_code

  - question: Are there indicators of automated DNS scanning versus manual enumeration?
    context: Timing and query patterns help distinguish between automated tools and manual reconnaissance.
    range: -1h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          alert.category: 'attempted-recon'
        condition: selection
      fields:
        - alert.signature
        - dst_ip
        - alert.severity

  # Type 6: Enterprise Correlation
  - question: Are other DNS servers receiving similar BIND fingerprinting attempts?
    context: Coordinated DNS fingerprinting suggests systematic network reconnaissance.
    range: -2h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          alert.signature: 'GPL DNS named authors attempt'
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - community_id

  - question: Is this part of a broader DNS infrastructure mapping campaign?
    context: DNS fingerprinting often occurs as part of larger network reconnaissance operations.
    range: -6h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          alert.signature|contains: 'DNS'
          alert.category: 'attempted-recon'
        condition: selection
      fields:
        - alert.signature
        - src_ip
        - dst_ip