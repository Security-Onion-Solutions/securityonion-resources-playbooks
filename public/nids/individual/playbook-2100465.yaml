name: GPL SCAN ISS Pinger
id: 22100465
description: |
  Detects ICMP ping packets containing ISS Pinger signature used by Internet Security Scanner.
  May indicate legitimate security scanning or unauthorized reconnaissance activity.
type: detection
detection_id: 2100465
detection_category:
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  # Type 1: Artifact Analysis
  - question: What was the exact ICMP payload containing the ISS Pinger signature?
    context: The specific payload structure confirms ISS scanner usage and version.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - payload
        - payload_printable
        - icmp_type
        - icmp_code

  - question: What ICMP packet characteristics were observed?
    context: ICMP packet details help distinguish between legitimate and malicious scanning.
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          document_id|expand: '%document_id%'
        condition: selection
      fields:
        - packet_info
        - proto
        - alert.signature

  # Type 2: Triage Assessment
  - question: Is this source authorized to perform security scanning?
    context: ISS scanners may be legitimately used by security teams for vulnerability assessment.
    range: -7d
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          alert.category: "attempted-recon"
        condition: selection
      fields:
        - dst_ip
        - alert.signature

  - question: Does the timing align with scheduled security assessments?
    context: Authorized scans typically occur during maintenance windows or scheduled assessments.
    range: -2h
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          proto: ICMP
        condition: selection
      fields:
        - dst_ip
        - flow_id

  # Type 3: Activity Context
  - question: What other reconnaissance activity originated from this source?
    context: Multiple scanning techniques may indicate comprehensive network enumeration.
    range: -1h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          alert.category:
            - "attempted-recon"
            - "network-scan"
        condition: selection
      fields:
        - dst_ip
        - alert.signature
        - alert.category

  - question: What was the scanning pattern and target selection?
    context: Understanding scan methodology helps determine threat sophistication.
    range: -30m
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          proto: ICMP
        condition: selection
      fields:
        - dst_ip
        - icmp_type

  - question: What network discovery preceded this ISS Pinger activity?
    context: Initial network discovery may indicate the start of a scanning campaign.
    range: -15m
    query: |
      aggregation: false
      logsource:
        category: network
        service: dns
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - dns.query.name
        - dns.resolved_ip
        - dns.query.type_name

  # Type 4: Impact Assessment
  - question: How many hosts responded to the ISS Pinger probes?
    context: Response patterns reveal active hosts and network topology to the scanner.
    range: +5m
    query: |
      aggregation: true
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip|expand: '%dst_ip%'
          dst_ip|expand: '%src_ip%'
          proto: ICMP
        condition: selection
      fields:
        - src_ip
        - icmp_type
        - icmp_code

  - question: Did the scanning activity escalate to port scanning or service enumeration?
    context: Follow-up activity indicates progression from host discovery to service identification.
    range: +1h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          alert.category:
            - "attempted-recon"
            - "network-scan"
        condition: selection
      fields:
        - dst_ip
        - alert.signature
        - dst_port

  # Type 5: Forensic Deep-Dive
  - question: What is the source IP's scanning methodology and tools?
    context: Tool fingerprinting helps identify the scanner type and potential threat actor.
    range: -2h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
        condition: selection
      fields:
        - alert.signature
        - alert.category
        - dst_port

  - question: Are there indicators of ISS or other commercial scanner usage?
    context: Commercial scanners have distinct signatures that help classify the activity.
    range: -1h
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          src_ip|expand: '%src_ip%'
          payload_printable|contains:
            - "ISS"
            - "Nessus"
            - "OpenVAS"
        condition: selection
      fields:
        - payload_printable
        - alert.signature

  # Type 6: Enterprise Correlation
  - question: Are multiple internal hosts being targeted by ISS Pinger scans?
    context: Broad targeting may indicate external reconnaissance of the entire network.
    range: -1h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          alert.signature_id: 2100465
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - alert.signature

  - question: Is this part of coordinated scanning activity across multiple vectors?
    context: Multi-vector scanning may indicate advanced threat actor reconnaissance.
    range: -2h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          alert.category: "attempted-recon"
        condition: selection
      fields:
        - src_ip
        - dst_ip
        - alert.signature