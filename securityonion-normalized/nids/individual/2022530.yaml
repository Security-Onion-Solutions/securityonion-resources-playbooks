name: ET WEB_CLIENT Fake Virus Phone Scam Landing Feb 17
id: 1245865
description: |
  Detects HTTP responses containing fake virus phone scam landing page content with specific CSS keyframes and styling.
  May indicate users visiting tech support scam sites or legitimate security research activities.
type: detection
detection_id: 2022530
detection_category: ''
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  - question: What was the complete HTTP response containing the fake virus scam content?
    context: Reveals the full scam page content and structure delivered to the user.
    range: +/-15m
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          community_id: '{network.community_id}'
        condition: selection
      fields:
        - http.method
        - http.useragent
        - http.virtual_host
        - http.uri
        - http.status_code
  - question: Does this host normally visit tech support or security-related websites?
    context: Determines if this represents typical browsing behavior for this user.
    range: -7d
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          dst_ip: '{destination.ip}'
        condition: selection
      fields:
        - dst_ip
  - question: What browser process accessed the fake virus scam landing page?
    context: Identifies the specific application and user session involved in the activity.
    range: +/-15m
    query: |
      aggregation: false
      logsource:
        category: network
      detection:
        selection:
          community_id: '{network.community_id}'
        filter:
          Image|exists: true
        condition: selection and filter
      fields:
        - hostname
        - User
        - Image
        - CommandLine
        - ProcessGuid
  - question: Did the user visit any other suspicious websites before or after this scam page?
    context: Identifies additional potentially malicious sites visited in the same session.
    range: +/-10m
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip: '{source.ip}'
        private:
          dst_ip|cidr:
            - '10.0.0.0/8'
            - '127.0.0.0/8'
            - '172.16.0.0/12'
            - '192.168.0.0/16'
            - '169.254.0.0/16'
        filter:
          dst_ip: '{network.public_ip}'
        condition: selection and not (private or filter)
      fields:
        - dst_ip
        - dst_port
        - network.transport
        - connection.state_description
  - question: Are other hosts in the organization accessing similar fake virus scam sites?
    context: Determines if this is part of a broader campaign targeting multiple users.
    range: +/-24h
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          dst_ip: '{network.public_ip}'
        filter:
          src_ip: '{source.ip}'
        condition: selection and not filter
      fields:
        - src_ip
        - dst_port
        - network.transport
        - connection.state_description
  - question: What DNS queries preceded the connection to this scam site?
    context: Reveals how the user was redirected to the fake virus landing page.
    range: -5m
    query: |
      aggregation: false
      logsource:
        category: network
        service: dns
      detection:
        selection:
          src_ip: '{source.ip}'
        condition: selection
      fields:
        - dns.query.name
        - dns.query.type_name
        - dns.resolved_ip
  - question: Did the user download any files after visiting the scam page?
    context: Identifies potential fake antivirus downloads or malicious software installations.
    range: +1h
    query: |
      aggregation: false
      logsource:
        category: file_event
      detection:
        selection:
          host.ip: '{network.private_ip}'
          file.name|endswith:
          - .exe
          - .dll
          - .bat
          - .cmd
          - .ps1
          - .vbs
          - .js
          - .scr
          - .com
          - .pif
        condition: selection
      fields:
        - file.path
        - file.name
        - Image
        - ProcessGuid
        - User
  - question: Were any suspicious processes executed after visiting the scam site?
    context: Detects potential fake tech support tools or remote access software installation.
    range: +2h
    query: |
      aggregation: false
      logsource:
        category: process_creation
      detection:
        selection:
          host.ip: '{network.private_ip}'
          Image|contains:
          - teamviewer.exe
          - anydesk.exe
          - chrome.exe
          - firefox.exe
          - msedge.exe
        condition: selection
      fields:
        - User
        - Image
        - CommandLine
        - ParentImage
        - ProcessGuid
  - question: Are there other alerts related to fake virus or tech support scams?
    context: Identifies related security events across the organization involving similar threats.
    range: +/-24h
    query: |
      aggregation: true
      logsource:
        category: alert
      detection:
        selection:
          dst_ip: '{network.public_ip}'
        condition: selection
      fields:
        - src_ip
        - rule.name
        - rule.category
  - question: Did this host attempt to contact any phone numbers or support services?
    context: Reveals DNS queries for tech support or customer service domains commonly used in scams.
    range: +/-4h
    query: |
      aggregation: false
      logsource:
        category: network
        service: dns
      detection:
        selection:
          src_ip: '{source.ip}'
          dns.query.name|contains:
            - support
            - help
            - tech
            - customer
            - service
            - microsoft
            - windows
            - antivirus
            - security
        condition: selection
      fields:
        - dns.query.name
        - dns.resolved_ip
  - question: What referrer patterns led users to this fake virus scam landing page?
    context: Identifies the distribution mechanism for the scam campaign.
    range: +/-6h
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          dst_ip: '{destination.ip}'
          http.method: GET
        condition: selection
      fields:
        - src_ip
        - http.virtual_host
        - http.uri
        - http.user_agent
        - http.request.referrer
