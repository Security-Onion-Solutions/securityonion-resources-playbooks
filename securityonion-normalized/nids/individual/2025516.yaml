name: ET PHISHING Bank of America Phishing Landing 2018-04-19
id: 1227496
description: |
  Detects Bank of America phishing pages based on specific HTML patterns including title elements and CSS references.
  May trigger on legitimate Bank of America websites or security awareness training platforms.
type: detection
detection_id: 2025516
detection_category: ''
detection_type: nids
contributors:
  - SecurityOnionSolutions
created: 2024-01-15
questions:
  - question: What was the complete HTTP response that triggered this phishing detection?
    context: Reveals the exact HTML content and structure of the suspected phishing page.
    range: +/-15m
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          community_id: '{network.community_id}'
        condition: selection
      fields:
        - http.method
        - http.useragent
        - http.virtual_host
        - http.uri
        - http.status_code
  - question: Does this host normally access Bank of America or financial services websites?
    context: Determines if banking website access is typical for this user or system.
    range: -7d
    query: |
      aggregation: true
      logsource:
        category: network
        service: http
      detection:
        selection:
          dst_ip: '{destination.ip}'
        condition: selection
      fields:
        - dst_ip
  - question: What user activity preceded the access to this suspected phishing site?
    context: Identifies how the user reached the phishing page and potential attack vector.
    range: -30m
    query: |
      aggregation: false
      logsource:
        category: network
      detection:
        selection:
          host.ip: '{related.ip}'
        filter:
          Image|exists: true
        condition: selection and filter
      fields:
        - src_ip
        - dst_ip
        - dst_port
        - network.transport
        - Image
        - ProcessGuid
        - User
        - CommandLine
  - question: What other external connections occurred from this host around the same time?
    context: Identifies additional malicious infrastructure or redirector sites.
    range: +/-10m
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          src_ip: '{source.ip}'
        private:
          dst_ip|cidr:
            - '10.0.0.0/8'
            - '127.0.0.0/8'
            - '172.16.0.0/12'
            - '192.168.0.0/16'
            - '169.254.0.0/16'
        filter:
          dst_ip: '{network.public_ip}'
        condition: selection and not (private or filter)
      fields:
        - dst_ip
        - dst_port
        - network.transport
        - connection.state_description
  - question: Are other hosts accessing the same phishing infrastructure?
    context: Determines the scope of the phishing campaign across the organization.
    range: +/-24h
    query: |
      aggregation: false
      logsource:
        category: network
        service: connection
      detection:
        selection:
          dst_ip: '{network.public_ip}'
        filter:
          src_ip: '{source.ip}'
        condition: selection and not filter
      fields:
        - src_ip
        - dst_port
        - network.transport
        - connection.state_description
  - question: What files were downloaded or created after accessing the phishing site?
    context: Identifies malware payloads or credential harvesting tools.
    range: +1h
    query: |
      aggregation: false
      logsource:
        category: file_event
      detection:
        selection:
          host.ip: '{network.private_ip}'
          file.name|endswith:
          - .exe
          - .dll
          - .bat
          - .cmd
          - .ps1
          - .vbs
          - .js
          - .scr
          - .com
          - .pif
        condition: selection
      fields:
        - file.path
        - file.name
        - Image
        - ProcessGuid
        - User
  - question: Did the user submit credentials or personal information to this site?
    context: Assesses potential credential compromise through POST request analysis.
    range: +30m
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip: '{source.ip}'
          dst_ip: '{destination.ip}'
          http.method: POST
        condition: selection
      fields:
        - http.uri
        - http.request.body.length
        - http.user_agent
  - question: What other Bank of America or financial phishing attempts occurred recently?
    context: Identifies related phishing campaigns targeting financial institutions.
    range: -7d
    query: |
      aggregation: false
      logsource:
        category: alert
      detection:
        selection:
          rule.name|contains:
            - "phishing"
            - "bank"
            - "financial"
        condition: selection
      fields:
        - rule.name
        - src_ip
        - dst_ip
        - alert.severity_label
  - question: Did this host access other suspicious websites with similar HTML patterns?
    context: Reveals additional phishing sites using the same kit or infrastructure.
    range: +/-6h
    query: |
      aggregation: false
      logsource:
        category: network
        service: http
      detection:
        selection:
          src_ip: '{source.ip}'
        suspicious_patterns:
          http.uri|contains:
            - "css/Untitled"
            - "WYSIWYG"
            - "signin"
            - "login"
        condition: selection and suspicious_patterns
      fields:
        - dst_ip
        - http.virtual_host
        - http.uri
        - http.user_agent
  - question: What DNS queries were made before accessing the phishing site?
    context: Identifies the domain resolution path and potential malicious redirectors.
    range: -5m
    query: |
      aggregation: false
      logsource:
        category: network
        service: dns
      detection:
        selection:
          src_ip: '{source.ip}'
        condition: selection
      fields:
        - dns.query.name
        - dns.query.type_name
        - dns.resolved_ip