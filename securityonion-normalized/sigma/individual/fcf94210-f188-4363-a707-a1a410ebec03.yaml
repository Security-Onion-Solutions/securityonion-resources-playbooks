name: Security Onion IDH - SSH Honeypot Access
id: 1600021
description: |
    Detects when attempts are made to access the IDH SSH service. This indicates potential malicious activity targeting SSH services. Review the username, password, and source IP for context.
type: detection
detection_id: 'fcf94210-f188-4363-a707-a1a410ebec03'
detection_category: ''
detection_type: 'sigma'
contributors:
  - 'SecurityOnionSolutions'
created: 2025-06-26
questions:
  - question: "Is the username used in the IDH SSH access attempt common/generic or organization-specific?"
    context: "This can provide insight into common attack patterns or if known credentials are being tested."
    query: |
        aggregation: false
        logsource:
            product: alert
        detection:
            selection:
                document_id: '{soc_id}'
            condition: selection
        fields:
            - event_data.logdata.USERNAME
  - question: "Is the password used in the IDH SSH access attempt common or organization-specific?"
    context: "The password attempted by the attacker. This helps identify common passwords being used in brute force attacks or if organization-specific credentials are being tested."
    query: |
        aggregation: false
        logsource:
            product: alert
        detection:
            selection:
                document_id: '{soc_id}'
            condition: selection
        fields:
            - event_data.logdata.PASSWORD
  - question: "What system is the source IP of the IDH SSH access attempt associated with?"
    context: "Is it an approved vulnerability scanner?"
    query: |
        aggregation: false
        logsource:
            product: alert
        detection:
            selection:
                document_id: '{soc_id}'
            condition: selection
        fields:
            - event_data.source.ip
  - question: "Are there other IDH alerts from this source IP?"
    context: "Check if this IP has triggered other IDH services, which can indicate broader reconnaissance or attack activity."
    range: -7d
    query: |
        aggregation: true
        logsource:
            product: alert
        detection:
            selection:
                event_data.source.ip: '{event_data.source.ip}'
            condition: selection
        fields:
            - event_data.logtype
            - event_data.destination.port
            - event_data.node_id
  - question: "What SSH client version was used by the attacker?"
    context: "The SSH client version can provide insight into the tools being used by the attacker."
    query: |
        aggregation: false
        logsource:
            product: alert
        detection:
            selection:
                document_id: '{soc_id}'
            condition: selection
        fields:
            - event_data.logdata.REMOTEVERSION
  - question: "Are there recent SSH honeypot attempts from other source IPs?"
    context: "Check for coordinated attacks or multiple attackers targeting SSH services across the honeypot infrastructure."
    range: -24h
    query: |
        aggregation: true
        logsource:
            product: alert
        detection:
            selection:
                event_data.logtype: 4002
            filter:
                event_data.source.ip: '{event_data.source.ip}'
            condition: selection and not filter
        fields:
            - event_data.source.ip
            - event_data.logdata.USERNAME
            - event_data.logdata.PASSWORD
            - event_data.node_id